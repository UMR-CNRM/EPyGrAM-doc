
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>epygram.geometries.UnstructuredGeometry — Unstructured Geometry class &#8212; epygram 1.5.2 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinxdoc.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="epygram.geometries.AcademicGeometry — Academic Geometry class" href="AcademicGeometry.html" />
    <link rel="prev" title="epygram.geometries.ProjectedGeometry — Projected Geometry class" href="ProjectedGeometry.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="AcademicGeometry.html" title="epygram.geometries.AcademicGeometry — Academic Geometry class"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="ProjectedGeometry.html" title="epygram.geometries.ProjectedGeometry — Projected Geometry class"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">epygram 1.5.2 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" ><code class="xref py py-mod docutils literal notranslate"><span class="pre">epygram</span></code> main package</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="geometries_lib.html" accesskey="U"><code class="xref py py-mod docutils literal notranslate"><span class="pre">epygram.geometries</span></code> — Geometries</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href=""><code class="xref py py-mod docutils literal notranslate"><span class="pre">epygram.geometries.UnstructuredGeometry</span></code> — Unstructured Geometry class</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="epygram-geometries-unstructuredgeometry-unstructured-geometry-class">
<h1><a class="reference internal" href="#module-epygram.geometries.UnstructuredGeometry" title="epygram.geometries.UnstructuredGeometry: Unstructured Geometry class"><code class="xref py py-mod docutils literal notranslate"><span class="pre">epygram.geometries.UnstructuredGeometry</span></code></a> — Unstructured Geometry class<a class="headerlink" href="#epygram-geometries-unstructuredgeometry-unstructured-geometry-class" title="Permalink to this headline">¶</a></h1>
<span class="target" id="module-epygram.geometries.UnstructuredGeometry"></span><p>Contains the classes for 3D geometries of fields.</p>
<hr class="docutils" />
<dl class="py class">
<dt class="sig sig-object py" id="epygram.geometries.UnstructuredGeometry.UnstructuredGeometry">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">epygram.geometries.UnstructuredGeometry.</span></span><span class="sig-name descname"><span class="pre">UnstructuredGeometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dimensions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vcoordinate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">position_on_horizontal_grid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'center'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">geoid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/UnstructuredGeometry.html#UnstructuredGeometry"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.UnstructuredGeometry.UnstructuredGeometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="Geometry.html#epygram.geometries.AbstractGeometry.RectangularGridGeometry" title="epygram.geometries.AbstractGeometry.RectangularGridGeometry"><code class="xref py py-class docutils literal notranslate"><span class="pre">epygram.geometries.AbstractGeometry.RectangularGridGeometry</span></code></a></p>
<p>Handles the geometry for an unstructured 3-Dimensions Field.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> – Name of geometrical type of representation of points on the Globe.
Name must be ‘unstructured’</p></li>
<li><p><strong>grid</strong> – Handles description of the horizontal grid.</p></li>
<li><p><strong>dimensions</strong> – Handles grid dimensions.</p></li>
<li><p><strong>vcoordinate</strong> – Handles vertical geometry parameters.</p></li>
<li><p><strong>position_on_horizontal_grid</strong> – <p>Position of points w/r to the horizontal.
among: [‘upper-right’, ‘upper-left’,</p>
<blockquote>
<div><p>’lower-left’, ‘lower-right’,
‘center-left’, ‘center-right’,
‘lower-center’, ‘upper-center’,
‘center’, ‘__unknown__’]</p>
</div></blockquote>
</p></li>
<li><p><strong>geoid</strong> – To specify geoid shape.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.UnstructuredGeometry.UnstructuredGeometry.get_lonlat_grid">
<span class="sig-name descname"><span class="pre">get_lonlat_grid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">subzone</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">position</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d4</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nb_validities</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force_longitudes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/UnstructuredGeometry.html#UnstructuredGeometry.get_lonlat_grid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.UnstructuredGeometry.UnstructuredGeometry.get_lonlat_grid" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a tuple of two tables containing one the longitude of each
point, the other the latitude, with 2D shape.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>subzone</strong> – <p>optional, among (‘C’, ‘CI’), for LAM grids only, returns
the grid resp. for the C or C+I zone off the C+I+E zone.</p>
<p>Default is no subzone, i.e. the whole field.</p>
</p></li>
<li><p><strong>position</strong> – position of lonlat grid with respect to the model cell.
Defaults to self.position_on_horizontal_grid.</p></li>
<li><p><strong>d4</strong> – <ul>
<li><p>if True,  returned values are shaped in a 4 dimensions array</p></li>
<li><dl class="simple">
<dt>if False, shape of returned values is determined with respect to geometry.</dt><dd><p>d4=True requires nb_validities &gt; 0</p>
</dd>
</dl>
</li>
</ul>
</p></li>
<li><p><strong>nb_validities</strong> – number of validities represented in data values</p></li>
<li><p><strong>force_longitudes</strong> – if ‘positive’, the longitudes will be forced positive
if ‘]-180,180]’, the longitudes will be in the ]-180, 180] interval</p></li>
</ul>
</dd>
</dl>
<p>Shape of 2D data on Rectangular grids:</p>
<blockquote>
<div><ul class="simple">
<li><p>grid[0,0] is SW, grid[-1,-1] is NE</p></li>
<li><p>grid[0,-1] is SE, grid[-1,0] is NW</p></li>
</ul>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.UnstructuredGeometry.UnstructuredGeometry.getcenter">
<span class="sig-name descname"><span class="pre">getcenter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">position</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/UnstructuredGeometry.html#UnstructuredGeometry.getcenter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.UnstructuredGeometry.UnstructuredGeometry.getcenter" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the coordinate of the grid center as a tuple of Angles
(center_lon, center_lat).</p>
<p>Caution: this is computed as the raw average of all grid points.
A barycentric computation would be more adequate.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.UnstructuredGeometry.UnstructuredGeometry.ij2ll">
<span class="sig-name descname"><span class="pre">ij2ll</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">position</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/UnstructuredGeometry.html#UnstructuredGeometry.ij2ll"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.UnstructuredGeometry.UnstructuredGeometry.ij2ll" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the (lon, lat) coordinates of point <em>(i,j)</em>, in degrees.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>i</strong> – X index of point in the 2D matrix of gridpoints</p></li>
<li><p><strong>j</strong> – Y index of point in the 2D matrix of gridpoints</p></li>
<li><p><strong>position</strong> – lat lon position to return with respect to the model cell.
Defaults to self.position_on_horizontal_grid.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.UnstructuredGeometry.UnstructuredGeometry.ll2ij">
<span class="sig-name descname"><span class="pre">ll2ij</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">position</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/UnstructuredGeometry.html#UnstructuredGeometry.ll2ij"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.UnstructuredGeometry.UnstructuredGeometry.ll2ij" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the (i, j) indexes of point <em>(lon, lat)</em> in degrees,
in the 2D matrix of gridpoints.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lon</strong> – longitude of point in degrees</p></li>
<li><p><strong>lat</strong> – latitude of point in degrees</p></li>
<li><p><strong>position</strong> – lat lon position to return with respect to the model cell.
Defaults to self.position_on_horizontal_grid.</p></li>
</ul>
</dd>
</dl>
<p>Caution: the returned (<em>i,j</em>) are float.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.UnstructuredGeometry.UnstructuredGeometry.nearest_points">
<span class="sig-name descname"><span class="pre">nearest_points</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">request</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">position</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">external_distance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">squeeze</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/UnstructuredGeometry.html#UnstructuredGeometry.nearest_points"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.UnstructuredGeometry.UnstructuredGeometry.nearest_points" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the (i, j) position of the points needed to perform an
interpolation. This is a list of (lon, lat) tuples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lon</strong> – longitude of point in degrees.</p></li>
<li><p><strong>lat</strong> – latitude of point in degrees.</p></li>
<li><p><strong>request</strong> – criteria for selecting the points, among:
* {‘n’:’1’} - the nearest point</p></li>
<li><p><strong>position</strong> – position in the model cell of the lat lon position.
Defaults to self.position_on_horizontal_grid.</p></li>
<li><p><strong>external_distance</strong> – can be a dict containing the target point value
and an external field on the same grid as self, to which the distance
is computed within the 4 horizontally nearest points; e.g.
{‘target_value’:4810, ‘external_field’:a_3DField_with_same_geometry}.
If so, the nearest point is selected with
distance = <a href="#id1"><span class="problematic" id="id2">|target_value - external_field.data|</span></a></p></li>
<li><p><strong>squeeze</strong> – True to suppress useless dimensions</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><p>general output form is [list, list, …, list]
with as many list items as the length of lon/lat.
Each list item is of the form [tuple, tuple, …, tuple]
with as many tuples as the request implies. A tuple
represents one of the nearest points associated with one
value taken from lon/lat. Each tuple as the form
(i, j).</p>
<p>Dimensions with a length of one are removed except if
squeeze is False. If squeeze is True and if request
implies only one nearest point, the list item of the general
output form is replaced by the tuple item; if length of
lon/lat is one, the output is directly the list item of
the general output form. Hence, if length of lon/lat is
one and the request implies only one point, the output is
a tuple.</p>
<p>In case of a simple square request, output is actually
an array. Otherwise, the output is as described (it cannot
be an array because the number of nearest points can vary
with the entry point).</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.UnstructuredGeometry.UnstructuredGeometry.resolution_ij">
<span class="sig-name descname"><span class="pre">resolution_ij</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">position</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/UnstructuredGeometry.html#UnstructuredGeometry.resolution_ij"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.UnstructuredGeometry.UnstructuredGeometry.resolution_ij" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the distance to the nearest point of (i,j) point.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>i</strong> – X index of point in the 2D matrix of gridpoints</p></li>
<li><p><strong>j</strong> – Y index of point in the 2D matrix of gridpoints</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.UnstructuredGeometry.UnstructuredGeometry.resolution_ll">
<span class="sig-name descname"><span class="pre">resolution_ll</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/UnstructuredGeometry.html#UnstructuredGeometry.resolution_ll"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.UnstructuredGeometry.UnstructuredGeometry.resolution_ll" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the local resolution at the nearest point of lon/lat.
It’s the distance between this point and its closest neighbour.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lon</strong> – longitude of point in degrees.</p></li>
<li><p><strong>lat</strong> – latitude of point in degrees.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="ProjectedGeometry.html"
                        title="previous chapter"><code class="xref py py-mod docutils literal notranslate"><span class="pre">epygram.geometries.ProjectedGeometry</span></code> — Projected Geometry class</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="AcademicGeometry.html"
                        title="next chapter"><code class="xref py py-mod docutils literal notranslate"><span class="pre">epygram.geometries.AcademicGeometry</span></code> — Academic Geometry class</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/library/UnstructuredGeometry.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="AcademicGeometry.html" title="epygram.geometries.AcademicGeometry — Academic Geometry class"
             >next</a> |</li>
        <li class="right" >
          <a href="ProjectedGeometry.html" title="epygram.geometries.ProjectedGeometry — Projected Geometry class"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">epygram 1.5.2 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" ><code class="xref py py-mod docutils literal notranslate"><span class="pre">epygram</span></code> main package</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="geometries_lib.html" ><code class="xref py py-mod docutils literal notranslate"><span class="pre">epygram.geometries</span></code> — Geometries</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href=""><code class="xref py py-mod docutils literal notranslate"><span class="pre">epygram.geometries.UnstructuredGeometry</span></code> — Unstructured Geometry class</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2014 --- 2024, A.Mary, S.Riette.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.3.2.
    </div>
  </body>
</html>