
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>epygram.geometries.D3Geometry — 3-D Geometry class &#8212; epygram 1.5.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinxdoc.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="epygram.geometries.H2DGeometry — Horizontal 2-D Geometry classes" href="H2DGeometry.html" />
    <link rel="prev" title="epygram.geometries — Geometries" href="geometries_lib.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="H2DGeometry.html" title="epygram.geometries.H2DGeometry — Horizontal 2-D Geometry classes"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="geometries_lib.html" title="epygram.geometries — Geometries"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">epygram 1.5.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" ><code class="xref py py-mod docutils literal notranslate"><span class="pre">epygram</span></code> — Package</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="geometries_lib.html" accesskey="U"><code class="xref py py-mod docutils literal notranslate"><span class="pre">epygram.geometries</span></code> — Geometries</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href=""><code class="xref py py-mod docutils literal notranslate"><span class="pre">epygram.geometries.D3Geometry</span></code> — 3-D Geometry class</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="module-epygram.geometries.D3Geometry">
<span id="epygram-geometries-d3geometry-3-d-geometry-class"></span><h1><a class="reference internal" href="#module-epygram.geometries.D3Geometry" title="epygram.geometries.D3Geometry: 3-D Geometry class"><code class="xref py py-mod docutils literal notranslate"><span class="pre">epygram.geometries.D3Geometry</span></code></a> — 3-D Geometry class<a class="headerlink" href="#module-epygram.geometries.D3Geometry" title="Permalink to this headline">¶</a></h1>
<p>Contains the classes for 3D geometries of fields.</p>
<hr class="docutils" />
<dl class="py class">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3Geometry">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">epygram.geometries.D3Geometry.</span></span><span class="sig-name descname"><span class="pre">D3Geometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/D3Geometry.html#D3Geometry"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.D3Geometry.D3Geometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="util.html#epygram.util.RecursiveObject" title="epygram.util.RecursiveObject"><code class="xref py py-class docutils literal notranslate"><span class="pre">epygram.util.RecursiveObject</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">footprints.FootprintBase</span></code></p>
<p>Handles the geometry for a 3-Dimensions Field.
Abstract mother class.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This class is managed by footprint.</p>
<blockquote>
<div><ul class="simple">
<li><p>info: Not documented</p></li>
<li><p>priority: PriorityLevel::DEFAULT (rank=1)</p></li>
</ul>
</div></blockquote>
<p>Automatic parameters from the footprint:</p>
<blockquote>
<div><ul class="simple">
<li><p><strong>dimensions</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">footprints.stdtypes.FPDict</span></code>) - rxx - Handles grid dimensions.</p></li>
<li><p><strong>geoid</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">footprints.stdtypes.FPDict</span></code>) - rxx - To specify geoid shape.</p>
<ul>
<li><p>Optional. Default is FPDict::&lt;&lt;as_dict:: dict(ellps = ‘WGS84’,)&gt;&gt;.</p></li>
</ul>
</li>
<li><p><strong>grid</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">footprints.stdtypes.FPDict</span></code>) - rxx - Handles description of the horizontal grid.</p></li>
<li><p><strong>name</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">builtins.str</span></code>) - rxx - Name of geometrical type of representation of points on                       the Globe.</p>
<ul>
<li><p>Values: set([‘mercator’, ‘unstructured’, ‘reduced_gauss’, ‘regular_lonlat’, ‘regular_gauss’, ‘rotated_lonlat’, ‘lambert’, ‘rotated_reduced_gauss’, ‘polar_stereographic’])</p></li>
</ul>
</li>
<li><p><strong>position_on_horizontal_grid</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">builtins.str</span></code>) - rwx - Position of points w/r to the horizontal.</p>
<ul>
<li><p>Optional. Default is ‘__unknown__’.</p></li>
<li><p>Values: set([‘lower-right’, ‘upper-left’, ‘__unknown__’, ‘upper-right’, ‘center-right’, ‘lower-center’, ‘center-left’, ‘center’, ‘upper-center’, ‘lower-left’])</p></li>
</ul>
</li>
<li><p><strong>structure</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">builtins.str</span></code>) - rxx - Type of geometry.</p>
<ul>
<li><p>Values: set([‘3D’])</p></li>
</ul>
</li>
<li><p><strong>vcoordinate</strong> (<a class="reference internal" href="VGeometry.html#epygram.geometries.VGeometry.VGeometry" title="epygram.geometries.VGeometry.VGeometry"><code class="xref py py-class docutils literal notranslate"><span class="pre">epygram.geometries.VGeometry.VGeometry</span></code></a>) - rwx - Handles vertical geometry parameters.</p></li>
</ul>
</div></blockquote>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3Geometry.azimuth">
<span class="sig-name descname"><span class="pre">azimuth</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/D3Geometry.html#D3Geometry.azimuth"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.D3Geometry.D3Geometry.azimuth" title="Permalink to this definition">¶</a></dt>
<dd><p>Initial bearing from <em>end1</em> to <em>end2</em> points following a Great Circle.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>end1</strong> – must be a tuple (lon, lat) in degrees.</p></li>
<li><p><strong>end2</strong> – must be a tuple (lon, lat) in degrees.</p></li>
</ul>
</dd>
</dl>
<p>Warning: requires the <code class="xref py py-mod docutils literal notranslate"><span class="pre">pyproj</span></code> module.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3Geometry.cartoplot_geometry">
<span class="sig-name descname"><span class="pre">cartoplot_geometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/D3Geometry.html#D3Geometry.cartoplot_geometry"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.D3Geometry.D3Geometry.cartoplot_geometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Makes a simple plot of the geometry, using cartopy.
For kwargs please refer to epygram.geometries.domain_making.output.cartoplot_rect_geometry</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3Geometry.datashape">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">datashape</span></span><a class="headerlink" href="#epygram.geometries.D3Geometry.D3Geometry.datashape" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the data shape requested by this geometry.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3Geometry.dimensions">
<span class="sig-name descname"><span class="pre">dimensions</span></span><a class="headerlink" href="#epygram.geometries.D3Geometry.D3Geometry.dimensions" title="Permalink to this definition">¶</a></dt>
<dd><p>Handles grid dimensions (see the documentation above for more details).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3Geometry.distance">
<span class="sig-name descname"><span class="pre">distance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/D3Geometry.html#D3Geometry.distance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.D3Geometry.D3Geometry.distance" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the distance between two points along a Great Circle.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>end1</strong> – first point, must be a tuple (lon, lat) in degrees.</p></li>
<li><p><strong>end2</strong> – second point, must be a tuple (lon, lat) in degrees.</p></li>
</ul>
</dd>
</dl>
<p>If one of (end1, end2) is a tuple of arrays (like (&lt;array of lon&gt;, &lt;array of lat&gt;))
the other one must be a scalar tuple or a tuple of arrays with same dimensions.</p>
<p>Warning: requires the <code class="xref py py-mod docutils literal notranslate"><span class="pre">pyproj</span></code> module.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3Geometry.eq_Hgeom">
<span class="sig-name descname"><span class="pre">eq_Hgeom</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/D3Geometry.html#D3Geometry.eq_Hgeom"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.D3Geometry.D3Geometry.eq_Hgeom" title="Permalink to this definition">¶</a></dt>
<dd><p>Tests if the horizontal part of the geometry is equal to
the horizontal part of another geometry.
:param: other: other geometry to use in the comparison</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3Geometry.geoid">
<span class="sig-name descname"><span class="pre">geoid</span></span><a class="headerlink" href="#epygram.geometries.D3Geometry.D3Geometry.geoid" title="Permalink to this definition">¶</a></dt>
<dd><p>To specify geoid shape (see the documentation above for more details).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3Geometry.get_levels">
<span class="sig-name descname"><span class="pre">get_levels</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d4</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nb_validities</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subzone</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/D3Geometry.html#D3Geometry.get_levels"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.D3Geometry.D3Geometry.get_levels" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an array containing the level for each data point.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>d4</strong> – <ul>
<li><p>if True,  returned values are shaped in a 4 dimensions array</p></li>
<li><p>if False, shape of returned values is determined with respect to geometry
d4=True requires nb_validities &gt; 0</p></li>
</ul>
</p></li>
<li><p><strong>nb_validities</strong> – the number of validities represented in data values</p></li>
<li><p><strong>subzone</strong> – optional, among (‘C’, ‘CI’), for LAM grids only, extracts
the levels resp. from the C or C+I zone off the C+I(+E) zone.</p></li>
</ul>
</dd>
</dl>
<p>Levels are internally stored with the vertical dimension first whereas this
method puts the time in first dimension.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3Geometry.grid">
<span class="sig-name descname"><span class="pre">grid</span></span><a class="headerlink" href="#epygram.geometries.D3Geometry.D3Geometry.grid" title="Permalink to this definition">¶</a></dt>
<dd><p>Handles description of the horizontal grid (see the documentation above for more details).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3Geometry.linspace">
<span class="sig-name descname"><span class="pre">linspace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/D3Geometry.html#D3Geometry.linspace"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.D3Geometry.D3Geometry.linspace" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns evenly spaced points over the specified interval.
Points are lined up along a Great Circle.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>end1</strong> – must be a tuple (lon, lat) in degrees.</p></li>
<li><p><strong>end2</strong> – must be a tuple (lon, lat) in degrees.</p></li>
<li><p><strong>num</strong> – the number of points, including point1 and point2.</p></li>
</ul>
</dd>
</dl>
<p>Warning: requires the <code class="xref py py-mod docutils literal notranslate"><span class="pre">pyproj</span></code> module.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3Geometry.make_field">
<span class="sig-name descname"><span class="pre">make_field</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/D3Geometry.html#D3Geometry.make_field"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.D3Geometry.D3Geometry.make_field" title="Permalink to this definition">¶</a></dt>
<dd><p>Make a field out of the geometry.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3Geometry.make_physicallevels_geometry">
<span class="sig-name descname"><span class="pre">make_physicallevels_geometry</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/D3Geometry.html#D3Geometry.make_physicallevels_geometry"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.D3Geometry.D3Geometry.make_physicallevels_geometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a new geometry excluding levels with no physical meaning.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>getdata</strong> – if False returns a field without data</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3Geometry.make_point_geometry">
<span class="sig-name descname"><span class="pre">make_point_geometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/D3Geometry.html#D3Geometry.make_point_geometry"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.D3Geometry.D3Geometry.make_point_geometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a PointGeometry at coordinates <em>(lon,lat)</em> in degrees.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3Geometry.make_profile_geometry">
<span class="sig-name descname"><span class="pre">make_profile_geometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/D3Geometry.html#D3Geometry.make_profile_geometry"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.D3Geometry.D3Geometry.make_profile_geometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a V1DGeometry at coordinates <em>(lon,lat)</em> in degrees.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3Geometry.make_section_geometry">
<span class="sig-name descname"><span class="pre">make_section_geometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">end1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">points_number</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resolution</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">position</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/D3Geometry.html#D3Geometry.make_section_geometry"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.D3Geometry.D3Geometry.make_section_geometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a V2DGeometry.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>end1</strong> – must be a tuple (lon, lat) in degrees.</p></li>
<li><p><strong>end2</strong> – must be a tuple (lon, lat) in degrees.</p></li>
<li><p><strong>points_number</strong> – defines the total number of horizontal points of the
section (including ends). If None, defaults to a number computed from
the <em>ends</em> and the <em>resolution</em>.</p></li>
<li><p><strong>resolution</strong> – defines the horizontal resolution to be given to the
field. If None, defaults to the horizontal resolution of the field.</p></li>
<li><p><strong>position</strong> – defines the position of data in the grid (for projected grids only)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3Geometry.make_zoom_geometry">
<span class="sig-name descname"><span class="pre">make_zoom_geometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">zoom</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra_10th</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/D3Geometry.html#D3Geometry.make_zoom_geometry"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.D3Geometry.D3Geometry.make_zoom_geometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an unstructured geometry with the points contained in <em>zoom</em>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>zoom</strong> – a dict(lonmin=, lonmax=, latmin=, latmax=).</p></li>
<li><p><strong>extra_10th</strong> – if True, add 1/10th of the X/Y extension of the zoom
(only usefull for the regular_lonlat grid implementation).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3Geometry.name">
<span class="sig-name descname"><span class="pre">name</span></span><a class="headerlink" href="#epygram.geometries.D3Geometry.D3Geometry.name" title="Permalink to this definition">¶</a></dt>
<dd><p>Name of geometrical type of representation of points on                       the Globe (see the documentation above for more details).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3Geometry.plotgeometry">
<span class="sig-name descname"><span class="pre">plotgeometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">plotlib</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cartopy'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/D3Geometry.html#D3Geometry.plotgeometry"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.D3Geometry.D3Geometry.plotgeometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Makes a simple plot of the geometry, with a number of options.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>plotlib</strong> – library to be used for plotting: ‘basemap’ is DEPRECATED;
‘cartopy’ (default) is recommended !</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3Geometry.position_on_horizontal_grid">
<span class="sig-name descname"><span class="pre">position_on_horizontal_grid</span></span><a class="headerlink" href="#epygram.geometries.D3Geometry.D3Geometry.position_on_horizontal_grid" title="Permalink to this definition">¶</a></dt>
<dd><p>Position of points w/r to the horizontal (see the documentation above for more details).</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3Geometry.projected_geometry">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">projected_geometry</span></span><a class="headerlink" href="#epygram.geometries.D3Geometry.D3Geometry.projected_geometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Is the geometry a projection ?</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3Geometry.rectangular_grid">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">rectangular_grid</span></span><a class="headerlink" href="#epygram.geometries.D3Geometry.D3Geometry.rectangular_grid" title="Permalink to this definition">¶</a></dt>
<dd><p>Is the grid rectangular ?</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3Geometry.structure">
<span class="sig-name descname"><span class="pre">structure</span></span><a class="headerlink" href="#epygram.geometries.D3Geometry.D3Geometry.structure" title="Permalink to this definition">¶</a></dt>
<dd><p>Type of geometry (see the documentation above for more details).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3Geometry.vcoord_as_field">
<span class="sig-name descname"><span class="pre">vcoord_as_field</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">surface_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">validity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">levels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/D3Geometry.html#D3Geometry.vcoord_as_field"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.D3Geometry.D3Geometry.vcoord_as_field" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a field filled with the level values associated to a fake geometry
:param validity: validities to associate with the returned field</p>
<blockquote>
<div><p>if None, we try without setting validity</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>surface_type</strong> – typeOfFirstFixedSurface to associate to the fake geometry</p></li>
<li><p><strong>levels</strong> – list of values to use as the levels of the fake geometry
if None, levels will be replaced by a range</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3Geometry.vcoordinate">
<span class="sig-name descname"><span class="pre">vcoordinate</span></span><a class="headerlink" href="#epygram.geometries.D3Geometry.D3Geometry.vcoordinate" title="Permalink to this definition">¶</a></dt>
<dd><p>Handles vertical geometry parameters (see the documentation above for more details).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3Geometry.what">
<span class="sig-name descname"><span class="pre">what</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">out=&lt;_io.TextIOWrapper</span> <span class="pre">name='&lt;stdout&gt;'</span> <span class="pre">mode='w'</span> <span class="pre">encoding='utf-8'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vertical_geometry=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arpifs_var_names=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spectral_geometry=None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/D3Geometry.html#D3Geometry.what"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.D3Geometry.D3Geometry.what" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes in file a summary of the geometry.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>out</strong> – the output open file-like object (duck-typing: <em>out</em>.write()
only is needed).</p></li>
<li><p><strong>vertical_geometry</strong> – if True, writes the vertical geometry of the
field.</p></li>
<li><p><strong>arpifs_var_names</strong> – if True, prints the equivalent ‘arpifs’ variable
names.</p></li>
<li><p><strong>spectral_geometry</strong> – an optional dict containing the spectral
truncatures {‘in_X’:, ‘in_Y’:}  (LAM) or {‘max’:} (global).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<hr class="docutils" />
<dl class="py class">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3RectangularGridGeometry">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">epygram.geometries.D3Geometry.</span></span><span class="sig-name descname"><span class="pre">D3RectangularGridGeometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/D3Geometry.html#D3RectangularGridGeometry"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.D3Geometry.D3RectangularGridGeometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#epygram.geometries.D3Geometry.D3Geometry" title="epygram.geometries.D3Geometry.D3Geometry"><code class="xref py py-class docutils literal notranslate"><span class="pre">epygram.geometries.D3Geometry.D3Geometry</span></code></a></p>
<p>Handles the geometry for a rectangular 3-Dimensions Field.
Abstract.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This class is managed by footprint.</p>
<blockquote>
<div><ul class="simple">
<li><p>info: Not documented</p></li>
<li><p>priority: PriorityLevel::DEFAULT (rank=1)</p></li>
</ul>
</div></blockquote>
<p>Automatic parameters from the footprint:</p>
<blockquote>
<div><ul class="simple">
<li><p><strong>dimensions</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">footprints.stdtypes.FPDict</span></code>) - rxx - Handles grid dimensions.</p></li>
<li><p><strong>geoid</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">footprints.stdtypes.FPDict</span></code>) - rxx - To specify geoid shape.</p>
<ul>
<li><p>Optional. Default is FPDict::&lt;&lt;as_dict:: dict(ellps = ‘WGS84’,)&gt;&gt;.</p></li>
</ul>
</li>
<li><p><strong>grid</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">footprints.stdtypes.FPDict</span></code>) - rxx - Handles description of the horizontal grid.</p></li>
<li><p><strong>name</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">builtins.str</span></code>) - rxx - Name of geometrical type of representation of points on                       the Globe.</p>
<ul>
<li><p>Values: set([‘mercator’, ‘unstructured’, ‘rotated_lonlat’, ‘lambert’, ‘academic’, ‘polar_stereographic’, ‘regular_lonlat’])</p></li>
</ul>
</li>
<li><p><strong>position_on_horizontal_grid</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">builtins.str</span></code>) - rwx - Position of points w/r to the horizontal.</p>
<ul>
<li><p>Optional. Default is ‘__unknown__’.</p></li>
<li><p>Values: set([‘lower-right’, ‘upper-left’, ‘__unknown__’, ‘upper-right’, ‘center-right’, ‘lower-center’, ‘center-left’, ‘center’, ‘upper-center’, ‘lower-left’])</p></li>
</ul>
</li>
<li><p><strong>structure</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">builtins.str</span></code>) - rxx - Type of geometry.</p>
<ul>
<li><p>Values: set([‘3D’])</p></li>
</ul>
</li>
<li><p><strong>vcoordinate</strong> (<a class="reference internal" href="VGeometry.html#epygram.geometries.VGeometry.VGeometry" title="epygram.geometries.VGeometry.VGeometry"><code class="xref py py-class docutils literal notranslate"><span class="pre">epygram.geometries.VGeometry.VGeometry</span></code></a>) - rwx - Handles vertical geometry parameters.</p></li>
</ul>
</div></blockquote>
</div>
<dl class="py attribute">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3RectangularGridGeometry.dimensions">
<span class="sig-name descname"><span class="pre">dimensions</span></span><a class="headerlink" href="#epygram.geometries.D3Geometry.D3RectangularGridGeometry.dimensions" title="Permalink to this definition">¶</a></dt>
<dd><p>Handles grid dimensions (see the documentation above for more details).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3RectangularGridGeometry.extract_subzone">
<span class="sig-name descname"><span class="pre">extract_subzone</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subzone</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/D3Geometry.html#D3RectangularGridGeometry.extract_subzone"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.D3Geometry.D3RectangularGridGeometry.extract_subzone" title="Permalink to this definition">¶</a></dt>
<dd><p>Extracts the subzone C or CI from a LAM field.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – the data values with shape concording with geometry.</p></li>
<li><p><strong>subzone</strong> – optional, among (‘C’, ‘CI’), for LAM grids only,
extracts the data resp. from the C or C+I zone off the C+I(+E) zone.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3RectangularGridGeometry.fill_maskedvalues">
<span class="sig-name descname"><span class="pre">fill_maskedvalues</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/D3Geometry.html#D3RectangularGridGeometry.fill_maskedvalues"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.D3Geometry.D3RectangularGridGeometry.fill_maskedvalues" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a copy of <em>data</em> with masked values filled with <em>fill_value</em>.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3RectangularGridGeometry.geoid">
<span class="sig-name descname"><span class="pre">geoid</span></span><a class="headerlink" href="#epygram.geometries.D3Geometry.D3RectangularGridGeometry.geoid" title="Permalink to this definition">¶</a></dt>
<dd><p>To specify geoid shape (see the documentation above for more details).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3RectangularGridGeometry.get_datashape">
<span class="sig-name descname"><span class="pre">get_datashape</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dimT</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force_dimZ</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d4</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subzone</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/D3Geometry.html#D3RectangularGridGeometry.get_datashape"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.D3Geometry.D3RectangularGridGeometry.get_datashape" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the data shape according to the geometry.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>force_dimZ</strong> – if supplied, force the Z dimension instead of that
of the vertical geometry</p></li>
<li><p><strong>dimT</strong> – if supplied, is the time dimension to be added to the
data shape</p></li>
<li><p><strong>d4</strong> – <ul>
<li><p>if True,  shape is 4D</p></li>
<li><p>if False, shape has only those &gt; 1</p></li>
</ul>
</p></li>
<li><p><strong>subzone</strong> – optional, among (‘C’, ‘CI’), for LAM grids only, informes that
data is resp. on the C or C+I zone off the C+I(+E) zone.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3RectangularGridGeometry.get_lonlat_grid">
<span class="sig-name descname"><span class="pre">get_lonlat_grid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">subzone</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">position</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d4</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nb_validities</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force_longitudes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/D3Geometry.html#D3RectangularGridGeometry.get_lonlat_grid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.D3Geometry.D3RectangularGridGeometry.get_lonlat_grid" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a tuple of two tables containing one the longitude of each
point, the other the latitude, with 2D shape.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>subzone</strong> – <p>optional, among (‘C’, ‘CI’), for LAM grids only, returns
the grid resp. for the C or C+I zone off the C+I+E zone.</p>
<p>Default is no subzone, i.e. the whole field.</p>
</p></li>
<li><p><strong>position</strong> – position of lonlat grid with respect to the model cell.
Defaults to self.position_on_horizontal_grid.</p></li>
<li><p><strong>d4</strong> – <ul>
<li><p>if True,  returned values are shaped in a 4 dimensions array</p></li>
<li><p>if False, shape of returned values is determined with
respect to geometry. d4=True requires nb_validities &gt; 0</p></li>
</ul>
</p></li>
<li><p><strong>nb_validities</strong> – number of validities represented in data values</p></li>
<li><p><strong>force_longitudes</strong> – if ‘positive’, the longitudes will be forced positive
if ‘]-180,180]’, the longitudes will be in the ]-180, 180] interval</p></li>
</ul>
</dd>
</dl>
<p>Shape of 2D data on Rectangular grids:</p>
<blockquote>
<div><ul class="simple">
<li><p>grid[0,0] is SW, grid[-1,-1] is NE</p></li>
<li><p>grid[0,-1] is SE, grid[-1,0] is NW</p></li>
</ul>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3RectangularGridGeometry.gimme_corners_ij">
<span class="sig-name descname"><span class="pre">gimme_corners_ij</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">subzone</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/D3Geometry.html#D3RectangularGridGeometry.gimme_corners_ij"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.D3Geometry.D3RectangularGridGeometry.gimme_corners_ij" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the indices (i, j) of the four corners of a rectangular grid,
as a dict(corner=(i, j)) with corner in:</p>
<p>ll = lower-left / lr = lower-right / ur = upper-right / ul = upper-left.</p>
<p>(0, 0) is always the lower-left corner of the grid.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>subzone</strong> – for LAM fields, returns the corners of the subzone.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3RectangularGridGeometry.gimme_corners_ll">
<span class="sig-name descname"><span class="pre">gimme_corners_ll</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">subzone</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">position</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/D3Geometry.html#D3RectangularGridGeometry.gimme_corners_ll"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.D3Geometry.D3RectangularGridGeometry.gimme_corners_ll" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the lon/lat of the four corners of a rectangular grid,
as a dict(corner=(lon, lat)) with corner in:</p>
<p>ll = lower-left / lr = lower-right / ur = upper-right / ul = upper-left.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>subzone</strong> – for LAM grids, returns the corners of the subzone.</p></li>
<li><p><strong>position</strong> – position of corners with respect to the model cell.
Defaults to self.position_on_horizontal_grid.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3RectangularGridGeometry.grid">
<span class="sig-name descname"><span class="pre">grid</span></span><a class="headerlink" href="#epygram.geometries.D3Geometry.D3RectangularGridGeometry.grid" title="Permalink to this definition">¶</a></dt>
<dd><p>Handles description of the horizontal grid (see the documentation above for more details).</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3RectangularGridGeometry.gridpoints_number">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">gridpoints_number</span></span><a class="headerlink" href="#epygram.geometries.D3Geometry.D3RectangularGridGeometry.gridpoints_number" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the number of gridpoints of the grid.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>subzone</strong> – <p>optional, among (‘C’, ‘CI’), for LAM grids only, returns
the grid resp. for the C or C+I zone off the C+I+E zone.</p>
<p>Default is no subzone, i.e. the whole field.</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3RectangularGridGeometry.horizontally_flattened">
<span class="sig-name descname"><span class="pre">horizontally_flattened</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/D3Geometry.html#D3RectangularGridGeometry.horizontally_flattened"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.D3Geometry.D3RectangularGridGeometry.horizontally_flattened" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a copy of <em>data</em> with horizontal dimensions flattened.
<em>data</em> must be 4D for simplicity reasons.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3RectangularGridGeometry.isglobal">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">isglobal</span></span><a class="headerlink" href="#epygram.geometries.D3Geometry.D3RectangularGridGeometry.isglobal" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>True if geometry is global</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3RectangularGridGeometry.make_subarray_geometry">
<span class="sig-name descname"><span class="pre">make_subarray_geometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">first_i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">last_i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_j</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">last_j</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/D3Geometry.html#D3RectangularGridGeometry.make_subarray_geometry"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.D3Geometry.D3RectangularGridGeometry.make_subarray_geometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Make a modified geometry consisting in a subarray of the grid, defined
by the indexes given as argument.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3RectangularGridGeometry.make_subsample_geometry">
<span class="sig-name descname"><span class="pre">make_subsample_geometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample_x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_z</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/D3Geometry.html#D3RectangularGridGeometry.make_subsample_geometry"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.D3Geometry.D3RectangularGridGeometry.make_subsample_geometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Make a sample geometry by decreasing resolution.
:param sample_x: take one over &lt;sample_x&gt; points in the x direction
:param sample_y: same for the y direction
:param sample_z: same for the z direction</p>
<p>CAUTION: if your grid contains non physical point, these points can be
retain in subsample. Use select_zone beforehand to suppress these points.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3RectangularGridGeometry.minmax_ll">
<span class="sig-name descname"><span class="pre">minmax_ll</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">subzone</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/D3Geometry.html#D3RectangularGridGeometry.minmax_ll"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.D3Geometry.D3RectangularGridGeometry.minmax_ll" title="Permalink to this definition">¶</a></dt>
<dd><p>Return min/max of lon/lat.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3RectangularGridGeometry.name">
<span class="sig-name descname"><span class="pre">name</span></span><a class="headerlink" href="#epygram.geometries.D3Geometry.D3RectangularGridGeometry.name" title="Permalink to this definition">¶</a></dt>
<dd><p>Name of geometrical type of representation of points on                       the Globe (see the documentation above for more details).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3RectangularGridGeometry.nearest_points">
<span class="sig-name descname"><span class="pre">nearest_points</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">request</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">position</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">external_distance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">squeeze</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/D3Geometry.html#D3RectangularGridGeometry.nearest_points"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.D3Geometry.D3RectangularGridGeometry.nearest_points" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the (i, j) positions of the nearest points.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lon</strong> – longitude of point in degrees.</p></li>
<li><p><strong>lat</strong> – latitude of point in degrees.</p></li>
<li><p><strong>request</strong> – <p>criteria for selecting the points, among:
* {‘n’:’1’} - the nearest point
* {‘n’:’2*2’} - the 2*2 square points around the position
* {‘n’:’4*4’} - the 4*4 square points around the position
* {‘n’:’N*N’} - the N*N square points around the position: N must be even
* {‘radius’:xxxx, ‘shape’:’square’} - the points which are xxxx metres</p>
<blockquote>
<div><p>around the position in X or Y direction</p>
</div></blockquote>
<ul>
<li><p>{‘radius’:xxxx, ‘shape’:’circle’} - the points within xxxx metres
around the position. (default shape == circle)</p></li>
</ul>
</p></li>
<li><p><strong>position</strong> – position in the model cell of the lat lon position.
Defaults to self.position_on_horizontal_grid.</p></li>
<li><p><strong>external_distance</strong> – can be a dict containing the target point value
and an external field on the same grid as self, to which the distance
is computed within the 4 horizontally nearest points; e.g.
{‘target_value’:4810, ‘external_field’:a_3DField_with_same_geometry}.
If so, the nearest point is selected with
distance = <a href="#id1"><span class="problematic" id="id2">|target_value - external_field.data|</span></a>
Only valid with request={‘n’:’1’}</p></li>
<li><p><strong>squeeze</strong> – True to suppress useless dimensions</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><p>general output form is [list, list, …, list]
with as many list items as the length of lon/lat.
Each list item is of the form [tuple, tuple, …, tuple]
with as many tuples as the request implies. A tuple
represents one of the nearest points associated with one
value taken from lon/lat. Each tuple as the form
(i, j).</p>
<p>Dimensions with a length of one are removed except if
squeeze is False. If squeeze is True and if request
implies only one nearest point, the list item of the general
output form is replaced by the tuple item; if length of
lon/lat is one, the output is directly the list item of
the general output form. Hence, if length of lon/lat is
one and the request implies only one point, the output is
a tuple.</p>
<p>In case of a simple square request, output is actually
an array. Otherwise, the output is as described (it cannot
be an array because the number of nearest points can vary
with the entry point).</p>
</p>
</dd>
</dl>
<p>In case of a {‘n’:’2*2’} request, order of points obtained on a rectangular grid is
(and must be) such that first and second point share the i position (hence
third and forth point also share the i position) and first and third share the j
position (hence the second and forth also share the j position).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3RectangularGridGeometry.point_is_inside_domain_ij">
<span class="sig-name descname"><span class="pre">point_is_inside_domain_ij</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">margin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subzone</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/D3Geometry.html#D3RectangularGridGeometry.point_is_inside_domain_ij"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.D3Geometry.D3RectangularGridGeometry.point_is_inside_domain_ij" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns True if the point(s) of i/j coordinates is(are) inside the
field.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>i</strong> – X index of point</p></li>
<li><p><strong>j</strong> – Y index of point.</p></li>
<li><p><strong>margin</strong> – considers the point inside if at least ‘margin’ points far
from the border. The -0.1 default is a safety for precision errors.</p></li>
<li><p><strong>subzone</strong> – considers only a subzone among (‘C’, ‘CI’) of the domain.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3RectangularGridGeometry.point_is_inside_domain_ll">
<span class="sig-name descname"><span class="pre">point_is_inside_domain_ll</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">margin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subzone</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">position</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/D3Geometry.html#D3RectangularGridGeometry.point_is_inside_domain_ll"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.D3Geometry.D3RectangularGridGeometry.point_is_inside_domain_ll" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns True if the point(s) of lon/lat coordinates is(are) inside the
field.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lon</strong> – longitude of point(s) in degrees.</p></li>
<li><p><strong>lat</strong> – latitude of point(s) in degrees.</p></li>
<li><p><strong>margin</strong> – considers the point inside if at least ‘margin’ points far
from the border. The -0.1 default is a safety for precision errors.</p></li>
<li><p><strong>subzone</strong> – considers only a subzone among (‘C’, ‘CI’) of the domain.</p></li>
<li><p><strong>position</strong> – position of the grid with respect to the model cell.
Defaults to self.position_on_horizontal_grid.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3RectangularGridGeometry.position_on_horizontal_grid">
<span class="sig-name descname"><span class="pre">position_on_horizontal_grid</span></span><a class="headerlink" href="#epygram.geometries.D3Geometry.D3RectangularGridGeometry.position_on_horizontal_grid" title="Permalink to this definition">¶</a></dt>
<dd><p>Position of points w/r to the horizontal (see the documentation above for more details).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3RectangularGridGeometry.reshape_data">
<span class="sig-name descname"><span class="pre">reshape_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_dimension</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d4</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subzone</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/D3Geometry.html#D3RectangularGridGeometry.reshape_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.D3Geometry.D3RectangularGridGeometry.reshape_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a 2D data (horizontal dimensions) reshaped from 1D,
according to geometry.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – the 1D data (or 3D with a T and Z dimensions,
or 2D with either a T/Z dimension, to be specified),
of dimension concording with geometry. In case data is 3D, T must be
first dimension and Z the second.</p></li>
<li><p><strong>first_dimension</strong> – in case data is 2D, specify what is the first
dimension of data among (‘T’, ‘Z’)</p></li>
<li><p><strong>subzone</strong> – optional, among (‘C’, ‘CI’), for LAM grids only, informes that
data is resp. on the C or C+I zone off the C+I(+E) zone.</p></li>
<li><p><strong>d4</strong> – <ul>
<li><p>if True,  returned values are shaped in a 4 dimensions array</p></li>
<li><p>if False, shape of returned values is determined with respect to geometry</p></li>
</ul>
</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3RectangularGridGeometry.structure">
<span class="sig-name descname"><span class="pre">structure</span></span><a class="headerlink" href="#epygram.geometries.D3Geometry.D3RectangularGridGeometry.structure" title="Permalink to this definition">¶</a></dt>
<dd><p>Type of geometry (see the documentation above for more details).</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3RectangularGridGeometry.vcoordinate">
<span class="sig-name descname"><span class="pre">vcoordinate</span></span><a class="headerlink" href="#epygram.geometries.D3Geometry.D3RectangularGridGeometry.vcoordinate" title="Permalink to this definition">¶</a></dt>
<dd><p>Handles vertical geometry parameters (see the documentation above for more details).</p>
</dd></dl>

</dd></dl>

<hr class="docutils" />
<dl class="py class">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3UnstructuredGeometry">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">epygram.geometries.D3Geometry.</span></span><span class="sig-name descname"><span class="pre">D3UnstructuredGeometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/D3Geometry.html#D3UnstructuredGeometry"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.D3Geometry.D3UnstructuredGeometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#epygram.geometries.D3Geometry.D3RectangularGridGeometry" title="epygram.geometries.D3Geometry.D3RectangularGridGeometry"><code class="xref py py-class docutils literal notranslate"><span class="pre">epygram.geometries.D3Geometry.D3RectangularGridGeometry</span></code></a></p>
<p>Handles the geometry for an unstructured 3-Dimensions Field.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This class is managed by footprint.</p>
<blockquote>
<div><ul class="simple">
<li><p>info: Not documented</p></li>
<li><p>priority: PriorityLevel::DEFAULT (rank=1)</p></li>
</ul>
</div></blockquote>
<p>Automatic parameters from the footprint:</p>
<blockquote>
<div><ul class="simple">
<li><p><strong>dimensions</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">footprints.stdtypes.FPDict</span></code>) - rxx - Handles grid dimensions.</p></li>
<li><p><strong>geoid</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">footprints.stdtypes.FPDict</span></code>) - rxx - To specify geoid shape.</p>
<ul>
<li><p>Optional. Default is FPDict::&lt;&lt;as_dict:: dict(ellps = ‘WGS84’,)&gt;&gt;.</p></li>
</ul>
</li>
<li><p><strong>grid</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">footprints.stdtypes.FPDict</span></code>) - rxx - Handles description of the horizontal grid.</p></li>
<li><p><strong>name</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">builtins.str</span></code>) - rxx - Name of geometrical type of representation of points on                       the Globe.</p>
<ul>
<li><p>Values: set([‘unstructured’])</p></li>
</ul>
</li>
<li><p><strong>position_on_horizontal_grid</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">builtins.str</span></code>) - rwx - Position of points w/r to the horizontal.</p>
<ul>
<li><p>Optional. Default is ‘center’.</p></li>
<li><p>Values: set([‘center’])</p></li>
</ul>
</li>
<li><p><strong>structure</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">builtins.str</span></code>) - rxx - Type of geometry.</p>
<ul>
<li><p>Values: set([‘3D’])</p></li>
</ul>
</li>
<li><p><strong>vcoordinate</strong> (<a class="reference internal" href="VGeometry.html#epygram.geometries.VGeometry.VGeometry" title="epygram.geometries.VGeometry.VGeometry"><code class="xref py py-class docutils literal notranslate"><span class="pre">epygram.geometries.VGeometry.VGeometry</span></code></a>) - rwx - Handles vertical geometry parameters.</p></li>
</ul>
</div></blockquote>
</div>
<dl class="py attribute">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3UnstructuredGeometry.dimensions">
<span class="sig-name descname"><span class="pre">dimensions</span></span><a class="headerlink" href="#epygram.geometries.D3Geometry.D3UnstructuredGeometry.dimensions" title="Permalink to this definition">¶</a></dt>
<dd><p>Handles grid dimensions (see the documentation above for more details).</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3UnstructuredGeometry.geoid">
<span class="sig-name descname"><span class="pre">geoid</span></span><a class="headerlink" href="#epygram.geometries.D3Geometry.D3UnstructuredGeometry.geoid" title="Permalink to this definition">¶</a></dt>
<dd><p>To specify geoid shape (see the documentation above for more details).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3UnstructuredGeometry.get_lonlat_grid">
<span class="sig-name descname"><span class="pre">get_lonlat_grid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">subzone</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">position</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d4</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nb_validities</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force_longitudes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/D3Geometry.html#D3UnstructuredGeometry.get_lonlat_grid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.D3Geometry.D3UnstructuredGeometry.get_lonlat_grid" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a tuple of two tables containing one the longitude of each
point, the other the latitude, with 2D shape.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>subzone</strong> – <p>optional, among (‘C’, ‘CI’), for LAM grids only, returns
the grid resp. for the C or C+I zone off the C+I+E zone.</p>
<p>Default is no subzone, i.e. the whole field.</p>
</p></li>
<li><p><strong>position</strong> – position of lonlat grid with respect to the model cell.
Defaults to self.position_on_horizontal_grid.</p></li>
<li><p><strong>d4</strong> – <ul>
<li><p>if True,  returned values are shaped in a 4 dimensions array</p></li>
<li><dl class="simple">
<dt>if False, shape of returned values is determined with respect to geometry.</dt><dd><p>d4=True requires nb_validities &gt; 0</p>
</dd>
</dl>
</li>
</ul>
</p></li>
<li><p><strong>nb_validities</strong> – number of validities represented in data values</p></li>
<li><p><strong>force_longitudes</strong> – if ‘positive’, the longitudes will be forced positive
if ‘]-180,180]’, the longitudes will be in the ]-180, 180] interval</p></li>
</ul>
</dd>
</dl>
<p>Shape of 2D data on Rectangular grids:</p>
<blockquote>
<div><ul class="simple">
<li><p>grid[0,0] is SW, grid[-1,-1] is NE</p></li>
<li><p>grid[0,-1] is SE, grid[-1,0] is NW</p></li>
</ul>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3UnstructuredGeometry.getcenter">
<span class="sig-name descname"><span class="pre">getcenter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">position</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/D3Geometry.html#D3UnstructuredGeometry.getcenter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.D3Geometry.D3UnstructuredGeometry.getcenter" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the coordinate of the grid center as a tuple of Angles
(center_lon, center_lat).</p>
<p>Caution: this is computed as the raw average of all grid points.
A barycentric computation would be more adequate.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3UnstructuredGeometry.grid">
<span class="sig-name descname"><span class="pre">grid</span></span><a class="headerlink" href="#epygram.geometries.D3Geometry.D3UnstructuredGeometry.grid" title="Permalink to this definition">¶</a></dt>
<dd><p>Handles description of the horizontal grid (see the documentation above for more details).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3UnstructuredGeometry.ij2ll">
<span class="sig-name descname"><span class="pre">ij2ll</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">position</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/D3Geometry.html#D3UnstructuredGeometry.ij2ll"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.D3Geometry.D3UnstructuredGeometry.ij2ll" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the (lon, lat) coordinates of point <em>(i,j)</em>, in degrees.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>i</strong> – X index of point in the 2D matrix of gridpoints</p></li>
<li><p><strong>j</strong> – Y index of point in the 2D matrix of gridpoints</p></li>
<li><p><strong>position</strong> – lat lon position to return with respect to the model cell.
Defaults to self.position_on_horizontal_grid.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3UnstructuredGeometry.ll2ij">
<span class="sig-name descname"><span class="pre">ll2ij</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">position</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/D3Geometry.html#D3UnstructuredGeometry.ll2ij"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.D3Geometry.D3UnstructuredGeometry.ll2ij" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the (i, j) indexes of point <em>(lon, lat)</em> in degrees,
in the 2D matrix of gridpoints.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lon</strong> – longitude of point in degrees</p></li>
<li><p><strong>lat</strong> – latitude of point in degrees</p></li>
<li><p><strong>position</strong> – lat lon position to return with respect to the model cell.
Defaults to self.position_on_horizontal_grid.</p></li>
</ul>
</dd>
</dl>
<p>Caution: the returned (<em>i,j</em>) are float.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3UnstructuredGeometry.name">
<span class="sig-name descname"><span class="pre">name</span></span><a class="headerlink" href="#epygram.geometries.D3Geometry.D3UnstructuredGeometry.name" title="Permalink to this definition">¶</a></dt>
<dd><p>Name of geometrical type of representation of points on                       the Globe (see the documentation above for more details).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3UnstructuredGeometry.nearest_points">
<span class="sig-name descname"><span class="pre">nearest_points</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">request</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">position</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">external_distance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">squeeze</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/D3Geometry.html#D3UnstructuredGeometry.nearest_points"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.D3Geometry.D3UnstructuredGeometry.nearest_points" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the (i, j) position of the points needed to perform an
interpolation. This is a list of (lon, lat) tuples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lon</strong> – longitude of point in degrees.</p></li>
<li><p><strong>lat</strong> – latitude of point in degrees.</p></li>
<li><p><strong>request</strong> – criteria for selecting the points, among:
* {‘n’:’1’} - the nearest point</p></li>
<li><p><strong>position</strong> – position in the model cell of the lat lon position.
Defaults to self.position_on_horizontal_grid.</p></li>
<li><p><strong>external_distance</strong> – can be a dict containing the target point value
and an external field on the same grid as self, to which the distance
is computed within the 4 horizontally nearest points; e.g.
{‘target_value’:4810, ‘external_field’:a_3DField_with_same_geometry}.
If so, the nearest point is selected with
distance = <a href="#id3"><span class="problematic" id="id4">|target_value - external_field.data|</span></a></p></li>
<li><p><strong>squeeze</strong> – True to suppress useless dimensions</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><p>general output form is [list, list, …, list]
with as many list items as the length of lon/lat.
Each list item is of the form [tuple, tuple, …, tuple]
with as many tuples as the request implies. A tuple
represents one of the nearest points associated with one
value taken from lon/lat. Each tuple as the form
(i, j).</p>
<p>Dimensions with a length of one are removed except if
squeeze is False. If squeeze is True and if request
implies only one nearest point, the list item of the general
output form is replaced by the tuple item; if length of
lon/lat is one, the output is directly the list item of
the general output form. Hence, if length of lon/lat is
one and the request implies only one point, the output is
a tuple.</p>
<p>In case of a simple square request, output is actually
an array. Otherwise, the output is as described (it cannot
be an array because the number of nearest points can vary
with the entry point).</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3UnstructuredGeometry.position_on_horizontal_grid">
<span class="sig-name descname"><span class="pre">position_on_horizontal_grid</span></span><a class="headerlink" href="#epygram.geometries.D3Geometry.D3UnstructuredGeometry.position_on_horizontal_grid" title="Permalink to this definition">¶</a></dt>
<dd><p>Position of points w/r to the horizontal (see the documentation above for more details).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3UnstructuredGeometry.resolution_ij">
<span class="sig-name descname"><span class="pre">resolution_ij</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">position</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/D3Geometry.html#D3UnstructuredGeometry.resolution_ij"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.D3Geometry.D3UnstructuredGeometry.resolution_ij" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the distance to the nearest point of (i,j) point.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>i</strong> – X index of point in the 2D matrix of gridpoints</p></li>
<li><p><strong>j</strong> – Y index of point in the 2D matrix of gridpoints</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3UnstructuredGeometry.resolution_ll">
<span class="sig-name descname"><span class="pre">resolution_ll</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/D3Geometry.html#D3UnstructuredGeometry.resolution_ll"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.D3Geometry.D3UnstructuredGeometry.resolution_ll" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the local resolution at the nearest point of lon/lat.
It’s the distance between this point and its closest neighbour.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lon</strong> – longitude of point in degrees.</p></li>
<li><p><strong>lat</strong> – latitude of point in degrees.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3UnstructuredGeometry.structure">
<span class="sig-name descname"><span class="pre">structure</span></span><a class="headerlink" href="#epygram.geometries.D3Geometry.D3UnstructuredGeometry.structure" title="Permalink to this definition">¶</a></dt>
<dd><p>Type of geometry (see the documentation above for more details).</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3UnstructuredGeometry.vcoordinate">
<span class="sig-name descname"><span class="pre">vcoordinate</span></span><a class="headerlink" href="#epygram.geometries.D3Geometry.D3UnstructuredGeometry.vcoordinate" title="Permalink to this definition">¶</a></dt>
<dd><p>Handles vertical geometry parameters (see the documentation above for more details).</p>
</dd></dl>

</dd></dl>

<hr class="docutils" />
<dl class="py class">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3AcademicGeometry">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">epygram.geometries.D3Geometry.</span></span><span class="sig-name descname"><span class="pre">D3AcademicGeometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/D3Geometry.html#D3AcademicGeometry"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.D3Geometry.D3AcademicGeometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#epygram.geometries.D3Geometry.D3RectangularGridGeometry" title="epygram.geometries.D3Geometry.D3RectangularGridGeometry"><code class="xref py py-class docutils literal notranslate"><span class="pre">epygram.geometries.D3Geometry.D3RectangularGridGeometry</span></code></a></p>
<p>Handles the geometry for an academic 3-Dimensions Field.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This class is managed by footprint.</p>
<blockquote>
<div><ul class="simple">
<li><p>info: Not documented</p></li>
<li><p>priority: PriorityLevel::DEFAULT (rank=1)</p></li>
</ul>
</div></blockquote>
<p>Automatic parameters from the footprint:</p>
<blockquote>
<div><ul class="simple">
<li><p><strong>dimensions</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">footprints.stdtypes.FPDict</span></code>) - rxx - Handles grid dimensions.</p></li>
<li><p><strong>geoid</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">footprints.stdtypes.FPDict</span></code>) - rxx - Of no meaning in this geometry.</p>
<ul>
<li><p>Optional. Default is FPDict::&lt;&lt;as_dict:: dict()&gt;&gt;.</p></li>
</ul>
</li>
<li><p><strong>grid</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">footprints.stdtypes.FPDict</span></code>) - rxx - Handles description of the horizontal grid.</p></li>
<li><p><strong>name</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">builtins.str</span></code>) - rxx - Name of geometrical type of representation of points on                       the Globe.</p>
<ul>
<li><p>Values: set([‘academic’])</p></li>
</ul>
</li>
<li><p><strong>position_on_horizontal_grid</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">builtins.str</span></code>) - rwx - Position of points w/r to the horizontal.</p>
<ul>
<li><p>Optional. Default is ‘__unknown__’.</p></li>
<li><p>Values: set([‘lower-right’, ‘upper-left’, ‘__unknown__’, ‘upper-right’, ‘center-right’, ‘lower-center’, ‘center-left’, ‘center’, ‘upper-center’, ‘lower-left’])</p></li>
</ul>
</li>
<li><p><strong>projection</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">footprints.stdtypes.FPDict</span></code>) - rxx - Handles projection information.</p></li>
<li><p><strong>structure</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">builtins.str</span></code>) - rxx - Type of geometry.</p>
<ul>
<li><p>Values: set([‘3D’])</p></li>
</ul>
</li>
<li><p><strong>vcoordinate</strong> (<a class="reference internal" href="VGeometry.html#epygram.geometries.VGeometry.VGeometry" title="epygram.geometries.VGeometry.VGeometry"><code class="xref py py-class docutils literal notranslate"><span class="pre">epygram.geometries.VGeometry.VGeometry</span></code></a>) - rwx - Handles vertical geometry parameters.</p></li>
</ul>
</div></blockquote>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3AcademicGeometry.azimuth">
<span class="sig-name descname"><span class="pre">azimuth</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">end1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/D3Geometry.html#D3AcademicGeometry.azimuth"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.D3Geometry.D3AcademicGeometry.azimuth" title="Permalink to this definition">¶</a></dt>
<dd><p>Same as plane_azimuth in this geometry.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3AcademicGeometry.dimensions">
<span class="sig-name descname"><span class="pre">dimensions</span></span><a class="headerlink" href="#epygram.geometries.D3Geometry.D3AcademicGeometry.dimensions" title="Permalink to this definition">¶</a></dt>
<dd><p>Handles grid dimensions (see the documentation above for more details).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3AcademicGeometry.distance">
<span class="sig-name descname"><span class="pre">distance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">end1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/D3Geometry.html#D3AcademicGeometry.distance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.D3Geometry.D3AcademicGeometry.distance" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the distance between two points along a straight line in the
geometry.
:param end1: must be a tuple (lon, lat) in degrees.
:param end2: must be a tuple (lon, lat) in degrees.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3AcademicGeometry.geoid">
<span class="sig-name descname"><span class="pre">geoid</span></span><a class="headerlink" href="#epygram.geometries.D3Geometry.D3AcademicGeometry.geoid" title="Permalink to this definition">¶</a></dt>
<dd><p>Of no meaning in this geometry (see the documentation above for more details).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3AcademicGeometry.getcenter">
<span class="sig-name descname"><span class="pre">getcenter</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/D3Geometry.html#D3AcademicGeometry.getcenter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.D3Geometry.D3AcademicGeometry.getcenter" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the coordinate of the grid center as a tuple
(center_lon, center_lat).</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3AcademicGeometry.grid">
<span class="sig-name descname"><span class="pre">grid</span></span><a class="headerlink" href="#epygram.geometries.D3Geometry.D3AcademicGeometry.grid" title="Permalink to this definition">¶</a></dt>
<dd><p>Handles description of the horizontal grid (see the documentation above for more details).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3AcademicGeometry.ij2ll">
<span class="sig-name descname"><span class="pre">ij2ll</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">position</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/D3Geometry.html#D3AcademicGeometry.ij2ll"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.D3Geometry.D3AcademicGeometry.ij2ll" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the (lon, lat) coordinates of point <em>(i,j)</em>, in degrees.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>i</strong> – X index of point in the 2D matrix of gridpoints</p></li>
<li><p><strong>j</strong> – Y index of point in the 2D matrix of gridpoints</p></li>
<li><p><strong>position</strong> – lat lon position to return with respect to the model cell.
Defaults to self.position_on_horizontal_grid.</p></li>
</ul>
</dd>
</dl>
<p>This routine has a special meaning for this geometry. It returns the (i, j)
position in the original grid (especially after a section extraction) with
an offset of one (for old tools compatibility).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3AcademicGeometry.ij2xy">
<span class="sig-name descname"><span class="pre">ij2xy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">position</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/D3Geometry.html#D3AcademicGeometry.ij2xy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.D3Geometry.D3AcademicGeometry.ij2xy" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the (x, y) coordinates of point <em>(i,j)</em>, in the projection.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>i</strong> – X index of point in the 2D matrix of gridpoints</p></li>
<li><p><strong>j</strong> – Y index of point in the 2D matrix of gridpoints</p></li>
<li><p><strong>position</strong> – position to return with respect to the model cell.
Defaults to self.position_on_horizontal_grid.</p></li>
</ul>
</dd>
</dl>
<p>Note that origin of coordinates in projection is the center of the C+I domain.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3AcademicGeometry.linspace">
<span class="sig-name descname"><span class="pre">linspace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">end1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/D3Geometry.html#D3AcademicGeometry.linspace"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.D3Geometry.D3AcademicGeometry.linspace" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns evenly spaced points over the specified interval.
Points are lined up in the geometry.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>end1</strong> – must be a tuple (lon, lat) in degrees.</p></li>
<li><p><strong>end2</strong> – must be a tuple (lon, lat) in degrees.</p></li>
<li><p><strong>num</strong> – number of points, including point1 and point2.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3AcademicGeometry.ll2ij">
<span class="sig-name descname"><span class="pre">ll2ij</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">position</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/D3Geometry.html#D3AcademicGeometry.ll2ij"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.D3Geometry.D3AcademicGeometry.ll2ij" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the (i, j) indexes of point <em>(lon, lat)</em> in degrees,
in the 2D matrix of gridpoints.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lon</strong> – longitude of point in degrees</p></li>
<li><p><strong>lat</strong> – latitude of point in degrees</p></li>
<li><p><strong>position</strong> – lat lon position to return with respect to the model cell.
Defaults to self.position_on_horizontal_grid.</p></li>
</ul>
</dd>
</dl>
<p>Caution: the returned (<em>i,j</em>) are float.</p>
<p>This routine has a special meaning for this geometry. It returns the (lon, lat)
position in the original grid (especially after a section extraction) with
an offset of one (for old tools compatibility).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3AcademicGeometry.ll2xy">
<span class="sig-name descname"><span class="pre">ll2xy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/D3Geometry.html#D3AcademicGeometry.ll2xy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.D3Geometry.D3AcademicGeometry.ll2xy" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the (x, y) coordinates of point <em>(lon, lat)</em> in degrees.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lon</strong> – longitude of point in degrees</p></li>
<li><p><strong>lat</strong> – latitude of point in degrees</p></li>
</ul>
</dd>
</dl>
<p>Note that origin of coordinates in projection is the center of the C+I
domain.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3AcademicGeometry.make_section_geometry">
<span class="sig-name descname"><span class="pre">make_section_geometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">end1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">points_number</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resolution</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">position</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/D3Geometry.html#D3AcademicGeometry.make_section_geometry"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.D3Geometry.D3AcademicGeometry.make_section_geometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a academic V2DGeometry.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>end1</strong> – must be a tuple (lon, lat) in degrees.</p></li>
<li><p><strong>end2</strong> – must be a tuple (lon, lat) in degrees.</p></li>
<li><p><strong>points_number</strong> – defines the total number of horizontal points of the
section (including ends). If None, defaults to a number computed from
the <em>ends</em> and the <em>resolution</em>.</p></li>
<li><p><strong>resolution</strong> – defines the horizontal resolution to be given to the
field. If None, defaults to the horizontal resolution of the field.</p></li>
<li><p><strong>position</strong> – defines the position of data in the grid (defaults to ‘center’)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3AcademicGeometry.name">
<span class="sig-name descname"><span class="pre">name</span></span><a class="headerlink" href="#epygram.geometries.D3Geometry.D3AcademicGeometry.name" title="Permalink to this definition">¶</a></dt>
<dd><p>Name of geometrical type of representation of points on                       the Globe (see the documentation above for more details).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3AcademicGeometry.plane_azimuth">
<span class="sig-name descname"><span class="pre">plane_azimuth</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">end1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/D3Geometry.html#D3AcademicGeometry.plane_azimuth"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.D3Geometry.D3AcademicGeometry.plane_azimuth" title="Permalink to this definition">¶</a></dt>
<dd><p>Initial bearing from <em>end1</em> to <em>end2</em> points in plane local referential
geometry.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>end1</strong> – must be a tuple (lon, lat) in degrees.</p></li>
<li><p><strong>end2</strong> – must be a tuple (lon, lat) in degrees.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3AcademicGeometry.position_on_horizontal_grid">
<span class="sig-name descname"><span class="pre">position_on_horizontal_grid</span></span><a class="headerlink" href="#epygram.geometries.D3Geometry.D3AcademicGeometry.position_on_horizontal_grid" title="Permalink to this definition">¶</a></dt>
<dd><p>Position of points w/r to the horizontal (see the documentation above for more details).</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3AcademicGeometry.projection">
<span class="sig-name descname"><span class="pre">projection</span></span><a class="headerlink" href="#epygram.geometries.D3Geometry.D3AcademicGeometry.projection" title="Permalink to this definition">¶</a></dt>
<dd><p>Handles projection information (see the documentation above for more details).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3AcademicGeometry.resolution_ij">
<span class="sig-name descname"><span class="pre">resolution_ij</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">_</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">__</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/D3Geometry.html#D3AcademicGeometry.resolution_ij"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.D3Geometry.D3AcademicGeometry.resolution_ij" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the minimum of X and Y resolution.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3AcademicGeometry.resolution_ll">
<span class="sig-name descname"><span class="pre">resolution_ll</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">_</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">__</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/D3Geometry.html#D3AcademicGeometry.resolution_ll"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.D3Geometry.D3AcademicGeometry.resolution_ll" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the minimum of X and Y resolution.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3AcademicGeometry.structure">
<span class="sig-name descname"><span class="pre">structure</span></span><a class="headerlink" href="#epygram.geometries.D3Geometry.D3AcademicGeometry.structure" title="Permalink to this definition">¶</a></dt>
<dd><p>Type of geometry (see the documentation above for more details).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3AcademicGeometry.tolerant_equal">
<span class="sig-name descname"><span class="pre">tolerant_equal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tolerance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.220446049250313e-16</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/D3Geometry.html#D3AcademicGeometry.tolerant_equal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.D3Geometry.D3AcademicGeometry.tolerant_equal" title="Permalink to this definition">¶</a></dt>
<dd><p>Test of equality by recursion on the object’s attributes,
with a <strong>tolerance</strong>.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3AcademicGeometry.vcoordinate">
<span class="sig-name descname"><span class="pre">vcoordinate</span></span><a class="headerlink" href="#epygram.geometries.D3Geometry.D3AcademicGeometry.vcoordinate" title="Permalink to this definition">¶</a></dt>
<dd><p>Handles vertical geometry parameters (see the documentation above for more details).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3AcademicGeometry.xy2ij">
<span class="sig-name descname"><span class="pre">xy2ij</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">position</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/D3Geometry.html#D3AcademicGeometry.xy2ij"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.D3Geometry.D3AcademicGeometry.xy2ij" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the (i, j) indexes of point <em>(x, y)</em>,
in the 2D matrix of gridpoints.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – X coordinate of point in the academic projection</p></li>
<li><p><strong>y</strong> – Y coordinate of point in the academic projection</p></li>
<li><p><strong>position</strong> – position to return with respect to the model cell.
Defaults to self.position_on_horizontal_grid.</p></li>
</ul>
</dd>
</dl>
<p>Caution: (<em>i,j</em>) are float (the nearest grid point is the nearest
integer).</p>
<p>Note that origin of coordinates in projection is the center of the C+I
domain.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3AcademicGeometry.xy2ll">
<span class="sig-name descname"><span class="pre">xy2ll</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/D3Geometry.html#D3AcademicGeometry.xy2ll"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.D3Geometry.D3AcademicGeometry.xy2ll" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the (lon, lat) coordinates of point <em>(x, y)</em> in the 2D matrix
of gridpoints*(i,j)*, in degrees.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – X coordinate of point in the academic projection</p></li>
<li><p><strong>y</strong> – Y coordinate of point in the academic projection</p></li>
</ul>
</dd>
</dl>
<p>Note that origin of coordinates in projection is the center of the C+I
domain.</p>
</dd></dl>

</dd></dl>

<hr class="docutils" />
<dl class="py class">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3RegLLGeometry">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">epygram.geometries.D3Geometry.</span></span><span class="sig-name descname"><span class="pre">D3RegLLGeometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/D3Geometry.html#D3RegLLGeometry"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.D3Geometry.D3RegLLGeometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#epygram.geometries.D3Geometry.D3RectangularGridGeometry" title="epygram.geometries.D3Geometry.D3RectangularGridGeometry"><code class="xref py py-class docutils literal notranslate"><span class="pre">epygram.geometries.D3Geometry.D3RectangularGridGeometry</span></code></a></p>
<p>Handles the geometry for a Regular Lon/Lat 3-Dimensions Field.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This class is managed by footprint.</p>
<blockquote>
<div><ul class="simple">
<li><p>info: Not documented</p></li>
<li><p>priority: PriorityLevel::DEFAULT (rank=1)</p></li>
</ul>
</div></blockquote>
<p>Automatic parameters from the footprint:</p>
<blockquote>
<div><ul class="simple">
<li><p><strong>dimensions</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">footprints.stdtypes.FPDict</span></code>) - rxx - Handles grid dimensions.</p></li>
<li><p><strong>geoid</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">footprints.stdtypes.FPDict</span></code>) - rxx - To specify geoid shape.</p>
<ul>
<li><p>Optional. Default is FPDict::&lt;&lt;as_dict:: dict(ellps = ‘WGS84’,)&gt;&gt;.</p></li>
</ul>
</li>
<li><p><strong>grid</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">footprints.stdtypes.FPDict</span></code>) - rxx - Handles description of the horizontal grid.</p></li>
<li><p><strong>name</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">builtins.str</span></code>) - rxx - Name of geometrical type of representation of points on                       the Globe.</p>
<ul>
<li><p>Values: set([‘regular_lonlat’])</p></li>
</ul>
</li>
<li><p><strong>position_on_horizontal_grid</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">builtins.str</span></code>) - rwx - Position of points w/r to the horizontal.</p>
<ul>
<li><p>Optional. Default is ‘__unknown__’.</p></li>
<li><p>Values: set([‘lower-right’, ‘upper-left’, ‘__unknown__’, ‘upper-right’, ‘center-right’, ‘lower-center’, ‘center-left’, ‘center’, ‘upper-center’, ‘lower-left’])</p></li>
</ul>
</li>
<li><p><strong>structure</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">builtins.str</span></code>) - rxx - Type of geometry.</p>
<ul>
<li><p>Values: set([‘3D’])</p></li>
</ul>
</li>
<li><p><strong>vcoordinate</strong> (<a class="reference internal" href="VGeometry.html#epygram.geometries.VGeometry.VGeometry" title="epygram.geometries.VGeometry.VGeometry"><code class="xref py py-class docutils literal notranslate"><span class="pre">epygram.geometries.VGeometry.VGeometry</span></code></a>) - rwx - Handles vertical geometry parameters.</p></li>
</ul>
</div></blockquote>
</div>
<dl class="py attribute">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3RegLLGeometry.dimensions">
<span class="sig-name descname"><span class="pre">dimensions</span></span><a class="headerlink" href="#epygram.geometries.D3Geometry.D3RegLLGeometry.dimensions" title="Permalink to this definition">¶</a></dt>
<dd><p>Handles grid dimensions (see the documentation above for more details).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3RegLLGeometry.distance">
<span class="sig-name descname"><span class="pre">distance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/D3Geometry.html#D3RegLLGeometry.distance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.D3Geometry.D3RegLLGeometry.distance" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the distance between two points along a straight line in the
geometry.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>end1</strong> – must be a tuple (lon, lat) in degrees.</p></li>
<li><p><strong>end2</strong> – must be a tuple (lon, lat) in degrees.</p></li>
</ul>
</dd>
</dl>
<p>Warning: requires the <code class="xref py py-mod docutils literal notranslate"><span class="pre">pyproj</span></code> module.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3RegLLGeometry.geoid">
<span class="sig-name descname"><span class="pre">geoid</span></span><a class="headerlink" href="#epygram.geometries.D3Geometry.D3RegLLGeometry.geoid" title="Permalink to this definition">¶</a></dt>
<dd><p>To specify geoid shape (see the documentation above for more details).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3RegLLGeometry.getcenter">
<span class="sig-name descname"><span class="pre">getcenter</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/D3Geometry.html#D3RegLLGeometry.getcenter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.D3Geometry.D3RegLLGeometry.getcenter" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the coordinate of the grid center as a tuple of Angles
(center_lon, center_lat).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3RegLLGeometry.global_shift_center">
<span class="sig-name descname"><span class="pre">global_shift_center</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">longitude_shift</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/D3Geometry.html#D3RegLLGeometry.global_shift_center"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.D3Geometry.D3RegLLGeometry.global_shift_center" title="Permalink to this definition">¶</a></dt>
<dd><p>Shifts the center of the geometry by <em>longitude_shift</em> (in degrees).
<em>longitude_shift</em> has to be a multiple of the grid’s resolution in
longitude.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3RegLLGeometry.grid">
<span class="sig-name descname"><span class="pre">grid</span></span><a class="headerlink" href="#epygram.geometries.D3Geometry.D3RegLLGeometry.grid" title="Permalink to this definition">¶</a></dt>
<dd><p>Handles description of the horizontal grid (see the documentation above for more details).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3RegLLGeometry.ij2ll">
<span class="sig-name descname"><span class="pre">ij2ll</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">position</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/D3Geometry.html#D3RegLLGeometry.ij2ll"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.D3Geometry.D3RegLLGeometry.ij2ll" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the (lon, lat) coordinates of point <em>(i,j)</em>, in degrees.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>i</strong> – X index of point in the 2D matrix of gridpoints</p></li>
<li><p><strong>j</strong> – Y index of point in the 2D matrix of gridpoints</p></li>
<li><p><strong>position</strong> – lat lon position to return with respect to the model cell.
Defaults to self.position_on_horizontal_grid.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3RegLLGeometry.ij2xy">
<span class="sig-name descname"><span class="pre">ij2xy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">position</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/D3Geometry.html#D3RegLLGeometry.ij2xy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.D3Geometry.D3RegLLGeometry.ij2xy" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the (x, y) coordinates of point <em>(i,j)</em>, in the projection.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>i</strong> – X index of point in the 2D matrix of gridpoints</p></li>
<li><p><strong>j</strong> – Y index of point in the 2D matrix of gridpoints</p></li>
<li><p><strong>position</strong> – position to return with respect to the model cell.
Defaults to self.position_on_horizontal_grid.</p></li>
</ul>
</dd>
</dl>
<p>Note that origin of coordinates in projection is the center of the C+I
domain.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3RegLLGeometry.isglobal">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">isglobal</span></span><a class="headerlink" href="#epygram.geometries.D3Geometry.D3RegLLGeometry.isglobal" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>True if geometry is global</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3RegLLGeometry.linspace">
<span class="sig-name descname"><span class="pre">linspace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">end1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/D3Geometry.html#D3RegLLGeometry.linspace"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.D3Geometry.D3RegLLGeometry.linspace" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns evenly spaced points over the specified interval.
Points are lined up in the geometry.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>end1</strong> – must be a tuple (lon, lat) in degrees.</p></li>
<li><p><strong>end2</strong> – must be a tuple (lon, lat) in degrees.</p></li>
<li><p><strong>num</strong> – number of points, including point1 and point2.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3RegLLGeometry.ll2ij">
<span class="sig-name descname"><span class="pre">ll2ij</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">position</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/D3Geometry.html#D3RegLLGeometry.ll2ij"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.D3Geometry.D3RegLLGeometry.ll2ij" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the (i, j) indexes of point <em>(lon, lat)</em> in degrees,
in the 2D matrix of gridpoints.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lon</strong> – longitude of point in degrees</p></li>
<li><p><strong>lat</strong> – latitude of point in degrees</p></li>
<li><p><strong>position</strong> – lat lon position to return with respect to the model cell.
Defaults to self.position_on_horizontal_grid.</p></li>
</ul>
</dd>
</dl>
<p>Caution: (<em>i,j</em>) are float.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3RegLLGeometry.ll2xy">
<span class="sig-name descname"><span class="pre">ll2xy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/D3Geometry.html#D3RegLLGeometry.ll2xy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.D3Geometry.D3RegLLGeometry.ll2xy" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the (x, y) coordinates of point <em>(lon, lat)</em> in degrees.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lon</strong> – longitude of point in degrees</p></li>
<li><p><strong>lat</strong> – latitude of point in degrees</p></li>
</ul>
</dd>
</dl>
<p>Note that origin of coordinates in projection is the center of the C+I
domain.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3RegLLGeometry.make_zoom_geometry">
<span class="sig-name descname"><span class="pre">make_zoom_geometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">zoom</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra_10th</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/D3Geometry.html#D3RegLLGeometry.make_zoom_geometry"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.D3Geometry.D3RegLLGeometry.make_zoom_geometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a new geometry with the points contained in <em>zoom</em>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>zoom</strong> – a dict(lonmin=, lonmax=, latmin=, latmax=).</p></li>
<li><p><strong>extra_10th</strong> – if True, add 1/10th of the X/Y extension of the zoom
(only usefull for the regular_lonlat grid implementation).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3RegLLGeometry.name">
<span class="sig-name descname"><span class="pre">name</span></span><a class="headerlink" href="#epygram.geometries.D3Geometry.D3RegLLGeometry.name" title="Permalink to this definition">¶</a></dt>
<dd><p>Name of geometrical type of representation of points on                       the Globe (see the documentation above for more details).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3RegLLGeometry.plane_azimuth">
<span class="sig-name descname"><span class="pre">plane_azimuth</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">end1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/D3Geometry.html#D3RegLLGeometry.plane_azimuth"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.D3Geometry.D3RegLLGeometry.plane_azimuth" title="Permalink to this definition">¶</a></dt>
<dd><p>Initial bearing from <em>end1</em> to <em>end2</em> points in plane local referential
geometry.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>end1</strong> – must be a tuple (lon, lat) in degrees.</p></li>
<li><p><strong>end2</strong> – must be a tuple (lon, lat) in degrees.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3RegLLGeometry.position_on_horizontal_grid">
<span class="sig-name descname"><span class="pre">position_on_horizontal_grid</span></span><a class="headerlink" href="#epygram.geometries.D3Geometry.D3RegLLGeometry.position_on_horizontal_grid" title="Permalink to this definition">¶</a></dt>
<dd><p>Position of points w/r to the horizontal (see the documentation above for more details).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3RegLLGeometry.resolution_ij">
<span class="sig-name descname"><span class="pre">resolution_ij</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/D3Geometry.html#D3RegLLGeometry.resolution_ij"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.D3Geometry.D3RegLLGeometry.resolution_ij" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the distance to the nearest point of (i,j) point.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>i</strong> – X index of point in the 2D matrix of gridpoints</p></li>
<li><p><strong>j</strong> – Y index of point in the 2D matrix of gridpoints</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3RegLLGeometry.resolution_ll">
<span class="sig-name descname"><span class="pre">resolution_ll</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/D3Geometry.html#D3RegLLGeometry.resolution_ll"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.D3Geometry.D3RegLLGeometry.resolution_ll" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the local resolution at the nearest point of lon/lat.
It’s the distance between this point and its closest neighbour.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lon</strong> – longitude of the point in degrees</p></li>
<li><p><strong>lat</strong> – latitude of the point in degrees</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3RegLLGeometry.structure">
<span class="sig-name descname"><span class="pre">structure</span></span><a class="headerlink" href="#epygram.geometries.D3Geometry.D3RegLLGeometry.structure" title="Permalink to this definition">¶</a></dt>
<dd><p>Type of geometry (see the documentation above for more details).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3RegLLGeometry.tolerant_equal">
<span class="sig-name descname"><span class="pre">tolerant_equal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tolerance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.220446049250313e-16</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/D3Geometry.html#D3RegLLGeometry.tolerant_equal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.D3Geometry.D3RegLLGeometry.tolerant_equal" title="Permalink to this definition">¶</a></dt>
<dd><p>Test of equality by recursion on the object’s attributes,
with a <strong>tolerance</strong>.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3RegLLGeometry.vcoordinate">
<span class="sig-name descname"><span class="pre">vcoordinate</span></span><a class="headerlink" href="#epygram.geometries.D3Geometry.D3RegLLGeometry.vcoordinate" title="Permalink to this definition">¶</a></dt>
<dd><p>Handles vertical geometry parameters (see the documentation above for more details).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3RegLLGeometry.xy2ij">
<span class="sig-name descname"><span class="pre">xy2ij</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">position</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/D3Geometry.html#D3RegLLGeometry.xy2ij"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.D3Geometry.D3RegLLGeometry.xy2ij" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the (i, j) indexes of point <em>(x, y)</em>,
in the 2D matrix of gridpoints.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – X coordinate of point in the projection</p></li>
<li><p><strong>y</strong> – Y coordinate of point in the projection</p></li>
<li><p><strong>position</strong> – position to return with respect to the model cell.
Defaults to self.position_on_horizontal_grid.</p></li>
</ul>
</dd>
</dl>
<p>Caution: (<em>i,j</em>) are float (the nearest grid point is the nearest
integer).</p>
<p>Note that origin of coordinates in projection is the center of the C+I
domain.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3RegLLGeometry.xy2ll">
<span class="sig-name descname"><span class="pre">xy2ll</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/D3Geometry.html#D3RegLLGeometry.xy2ll"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.D3Geometry.D3RegLLGeometry.xy2ll" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the (lon, lat) coordinates of point <em>(x, y)</em> in the 2D matrix
of gridpoints*(i,j)*, in degrees.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – X coordinate of point in the projection</p></li>
<li><p><strong>y</strong> – Y coordinate of point in the projection</p></li>
</ul>
</dd>
</dl>
<p>Note that origin of coordinates in projection is the center of the C+I
domain.</p>
</dd></dl>

</dd></dl>

<hr class="docutils" />
<dl class="py class">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3ProjectedGeometry">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">epygram.geometries.D3Geometry.</span></span><span class="sig-name descname"><span class="pre">D3ProjectedGeometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/D3Geometry.html#D3ProjectedGeometry"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.D3Geometry.D3ProjectedGeometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#epygram.geometries.D3Geometry.D3RectangularGridGeometry" title="epygram.geometries.D3Geometry.D3RectangularGridGeometry"><code class="xref py py-class docutils literal notranslate"><span class="pre">epygram.geometries.D3Geometry.D3RectangularGridGeometry</span></code></a></p>
<p>Handles the geometry for a Projected 3-Dimensions Field.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This class is managed by footprint.</p>
<blockquote>
<div><ul class="simple">
<li><p>info: Not documented</p></li>
<li><p>priority: PriorityLevel::DEFAULT (rank=1)</p></li>
</ul>
</div></blockquote>
<p>Automatic parameters from the footprint:</p>
<blockquote>
<div><ul class="simple">
<li><p><strong>dimensions</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">footprints.stdtypes.FPDict</span></code>) - rxx - Handles grid dimensions.</p></li>
<li><p><strong>geoid</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">footprints.stdtypes.FPDict</span></code>) - rxx - To specify geoid shape.</p>
<ul>
<li><p>Optional. Default is FPDict::&lt;&lt;as_dict:: dict(ellps = ‘WGS84’,)&gt;&gt;.</p></li>
</ul>
</li>
<li><p><strong>grid</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">footprints.stdtypes.FPDict</span></code>) - rxx - Handles description of the horizontal grid.</p></li>
<li><p><strong>name</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">builtins.str</span></code>) - rxx - Name of geometrical type of representation of points on                       the Globe.</p>
<ul>
<li><p>Values: set([‘mercator’, ‘space_view’, ‘polar_stereographic’, ‘lambert’])</p></li>
</ul>
</li>
<li><p><strong>position_on_horizontal_grid</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">builtins.str</span></code>) - rwx - Position of points w/r to the horizontal.</p>
<ul>
<li><p>Optional. Default is ‘__unknown__’.</p></li>
<li><p>Values: set([‘lower-right’, ‘upper-left’, ‘__unknown__’, ‘upper-right’, ‘center-right’, ‘lower-center’, ‘center-left’, ‘center’, ‘upper-center’, ‘lower-left’])</p></li>
</ul>
</li>
<li><p><strong>projection</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">footprints.stdtypes.FPDict</span></code>) - rxx - Handles projection information.</p></li>
<li><p><strong>structure</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">builtins.str</span></code>) - rxx - Type of geometry.</p>
<ul>
<li><p>Values: set([‘3D’])</p></li>
</ul>
</li>
<li><p><strong>vcoordinate</strong> (<a class="reference internal" href="VGeometry.html#epygram.geometries.VGeometry.VGeometry" title="epygram.geometries.VGeometry.VGeometry"><code class="xref py py-class docutils literal notranslate"><span class="pre">epygram.geometries.VGeometry.VGeometry</span></code></a>) - rwx - Handles vertical geometry parameters.</p></li>
</ul>
</div></blockquote>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3ProjectedGeometry.compass_grid">
<span class="sig-name descname"><span class="pre">compass_grid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">subzone</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">position</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/D3Geometry.html#D3ProjectedGeometry.compass_grid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.D3Geometry.D3ProjectedGeometry.compass_grid" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the compass grid, i.e. the angle between Y-axis and North for each
gridpoint.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>subzone</strong> – <p>optional, among (‘C’, ‘CI’), for LAM grids only, returns
the grid resp. for the C or C+I zone off the C+I+E zone.</p>
<p>Default is no subzone, i.e. the whole field.</p>
</p></li>
<li><p><strong>position</strong> – position of lonlat grid with respect to the model cell.
Defaults to self.position_on_horizontal_grid.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3ProjectedGeometry.dimensions">
<span class="sig-name descname"><span class="pre">dimensions</span></span><a class="headerlink" href="#epygram.geometries.D3Geometry.D3ProjectedGeometry.dimensions" title="Permalink to this definition">¶</a></dt>
<dd><p>Handles grid dimensions (see the documentation above for more details).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3ProjectedGeometry.distance">
<span class="sig-name descname"><span class="pre">distance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">end1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/D3Geometry.html#D3ProjectedGeometry.distance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.D3Geometry.D3ProjectedGeometry.distance" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the distance between two points along a straight line in the
geometry.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>end1</strong> – must be a tuple (lon, lat) in degrees.</p></li>
<li><p><strong>end2</strong> – must be a tuple (lon, lat) in degrees.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3ProjectedGeometry.geoid">
<span class="sig-name descname"><span class="pre">geoid</span></span><a class="headerlink" href="#epygram.geometries.D3Geometry.D3ProjectedGeometry.geoid" title="Permalink to this definition">¶</a></dt>
<dd><p>To specify geoid shape (see the documentation above for more details).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3ProjectedGeometry.getcenter">
<span class="sig-name descname"><span class="pre">getcenter</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/D3Geometry.html#D3ProjectedGeometry.getcenter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.D3Geometry.D3ProjectedGeometry.getcenter" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the coordinate of the grid center as a tuple of Angles
(center_lon, center_lat).</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3ProjectedGeometry.grid">
<span class="sig-name descname"><span class="pre">grid</span></span><a class="headerlink" href="#epygram.geometries.D3Geometry.D3ProjectedGeometry.grid" title="Permalink to this definition">¶</a></dt>
<dd><p>Handles description of the horizontal grid (see the documentation above for more details).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3ProjectedGeometry.ij2ll">
<span class="sig-name descname"><span class="pre">ij2ll</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">position</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/D3Geometry.html#D3ProjectedGeometry.ij2ll"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.D3Geometry.D3ProjectedGeometry.ij2ll" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the (lon, lat) coordinates of point <em>(i,j)</em>, in degrees.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>i</strong> – X index of point in the 2D matrix of gridpoints</p></li>
<li><p><strong>j</strong> – Y index of point in the 2D matrix of gridpoints</p></li>
<li><p><strong>position</strong> – lat lon position to return with respect to the model cell.
Defaults to self.position_on_horizontal_grid.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3ProjectedGeometry.ij2xy">
<span class="sig-name descname"><span class="pre">ij2xy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">position</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/D3Geometry.html#D3ProjectedGeometry.ij2xy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.D3Geometry.D3ProjectedGeometry.ij2xy" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the (x, y) coordinates of point <em>(i,j)</em>, in the projection.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>i</strong> – X index of point in the 2D matrix of gridpoints</p></li>
<li><p><strong>j</strong> – Y index of point in the 2D matrix of gridpoints</p></li>
<li><p><strong>position</strong> – position to return with respect to the model cell.
Defaults to self.position_on_horizontal_grid.</p></li>
</ul>
</dd>
</dl>
<p>Note that origin of coordinates in projection is the center of the C+I
domain.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3ProjectedGeometry.linspace">
<span class="sig-name descname"><span class="pre">linspace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">end1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/D3Geometry.html#D3ProjectedGeometry.linspace"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.D3Geometry.D3ProjectedGeometry.linspace" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns evenly spaced points over the specified interval.
Points are lined up in the geometry.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>end1</strong> – must be a tuple (lon, lat) in degrees.</p></li>
<li><p><strong>end2</strong> – must be a tuple (lon, lat) in degrees.</p></li>
<li><p><strong>num</strong> – number of points, including point1 and point2.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3ProjectedGeometry.ll2ij">
<span class="sig-name descname"><span class="pre">ll2ij</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">position</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/D3Geometry.html#D3ProjectedGeometry.ll2ij"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.D3Geometry.D3ProjectedGeometry.ll2ij" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the (i, j) indexes of point <em>(lon, lat)</em> in degrees,
in the 2D matrix of gridpoints.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lon</strong> – longitude of point in degrees</p></li>
<li><p><strong>lat</strong> – latitude of point in degrees</p></li>
<li><p><strong>position</strong> – lat lon position to return with respect to the model cell.
Defaults to self.position_on_horizontal_grid.</p></li>
</ul>
</dd>
</dl>
<p>Caution: (<em>i,j</em>) are float.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3ProjectedGeometry.ll2xy">
<span class="sig-name descname"><span class="pre">ll2xy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/D3Geometry.html#D3ProjectedGeometry.ll2xy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.D3Geometry.D3ProjectedGeometry.ll2xy" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the (x, y) coordinates of point <em>(lon, lat)</em> in degrees.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lon</strong> – longitude of point in degrees</p></li>
<li><p><strong>lat</strong> – latitude of point in degrees</p></li>
</ul>
</dd>
</dl>
<p>Note that origin of coordinates in projection is the center of the C+I
domain.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3ProjectedGeometry.make_section_geometry">
<span class="sig-name descname"><span class="pre">make_section_geometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">end1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">points_number</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resolution</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">position</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/D3Geometry.html#D3ProjectedGeometry.make_section_geometry"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.D3Geometry.D3ProjectedGeometry.make_section_geometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a projected V2DGeometry.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>end1</strong> – must be a tuple (lon, lat) in degrees.</p></li>
<li><p><strong>end2</strong> – must be a tuple (lon, lat) in degrees.</p></li>
<li><p><strong>points_number</strong> – defines the total number of horizontal points of the
section (including ends). If None, defaults to a number computed from
the <em>ends</em> and the <em>resolution</em>.</p></li>
<li><p><strong>resolution</strong> – defines the horizontal resolution to be given to the
field. If None, defaults to the horizontal resolution of the field.</p></li>
<li><p><strong>position</strong> – defines the position of data in the grid (defaults to ‘center’)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3ProjectedGeometry.map_factor">
<span class="sig-name descname"><span class="pre">map_factor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lat</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/D3Geometry.html#D3ProjectedGeometry.map_factor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.D3Geometry.D3ProjectedGeometry.map_factor" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the map factor at the given latitude(s) <em>lat</em> in degrees.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3ProjectedGeometry.map_factor_field">
<span class="sig-name descname"><span class="pre">map_factor_field</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">position</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/D3Geometry.html#D3ProjectedGeometry.map_factor_field"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.D3Geometry.D3ProjectedGeometry.map_factor_field" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a new field whose data is the map factor over the field.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>position</strong> – grid position with respect to the model cell.
Defaults to self.position_on_horizontal_grid.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3ProjectedGeometry.mesh_area">
<span class="sig-name descname"><span class="pre">mesh_area</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lat</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/D3Geometry.html#D3ProjectedGeometry.mesh_area"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.D3Geometry.D3ProjectedGeometry.mesh_area" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the area of a mesh/gridpoint, given its latitude.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3ProjectedGeometry.mesh_area_field">
<span class="sig-name descname"><span class="pre">mesh_area_field</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">position</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/D3Geometry.html#D3ProjectedGeometry.mesh_area_field"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.D3Geometry.D3ProjectedGeometry.mesh_area_field" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a new field whose data is the mesh area of gridpoints,
i.e. X_resolution x Y_resolution / m^2, where m is the local map factor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>position</strong> – grid position with respect to the model cell.
Defaults to self.position_on_horizontal_grid.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3ProjectedGeometry.name">
<span class="sig-name descname"><span class="pre">name</span></span><a class="headerlink" href="#epygram.geometries.D3Geometry.D3ProjectedGeometry.name" title="Permalink to this definition">¶</a></dt>
<dd><p>Name of geometrical type of representation of points on                       the Globe (see the documentation above for more details).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3ProjectedGeometry.plane_azimuth">
<span class="sig-name descname"><span class="pre">plane_azimuth</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">end1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/D3Geometry.html#D3ProjectedGeometry.plane_azimuth"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.D3Geometry.D3ProjectedGeometry.plane_azimuth" title="Permalink to this definition">¶</a></dt>
<dd><p>Initial bearing from <em>end1</em> to <em>end2</em> points in plane local referential
geometry.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>end1</strong> – must be a tuple (lon, lat) in degrees.</p></li>
<li><p><strong>end2</strong> – must be a tuple (lon, lat) in degrees.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3ProjectedGeometry.position_on_horizontal_grid">
<span class="sig-name descname"><span class="pre">position_on_horizontal_grid</span></span><a class="headerlink" href="#epygram.geometries.D3Geometry.D3ProjectedGeometry.position_on_horizontal_grid" title="Permalink to this definition">¶</a></dt>
<dd><p>Position of points w/r to the horizontal (see the documentation above for more details).</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3ProjectedGeometry.projection">
<span class="sig-name descname"><span class="pre">projection</span></span><a class="headerlink" href="#epygram.geometries.D3Geometry.D3ProjectedGeometry.projection" title="Permalink to this definition">¶</a></dt>
<dd><p>Handles projection information (see the documentation above for more details).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3ProjectedGeometry.reproject_wind_on_lonlat">
<span class="sig-name descname"><span class="pre">reproject_wind_on_lonlat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">map_factor_correction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reverse</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/D3Geometry.html#D3ProjectedGeometry.reproject_wind_on_lonlat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.D3Geometry.D3ProjectedGeometry.reproject_wind_on_lonlat" title="Permalink to this definition">¶</a></dt>
<dd><p>Reprojects a wind vector (u, v) on the grid onto real
axes, i.e. with components on true zonal/meridian axes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>u</strong> – the u == zonal-on-the-grid component of wind</p></li>
<li><p><strong>v</strong> – the v == meridian-on-the-grid component of wind</p></li>
<li><p><strong>lon</strong> – longitudes of points in degrees, if u/v are not vectors
on the whole grid</p></li>
<li><p><strong>lat</strong> – latitudes of points in degrees, if u/v are not vectors
on the whole grid</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>:param map_factor_correction:, applies a correction of magnitude due</dt><dd><p>to map factor.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>reverse</strong> – if True, apply the reverse reprojection.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3ProjectedGeometry.resolution_ij">
<span class="sig-name descname"><span class="pre">resolution_ij</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/D3Geometry.html#D3ProjectedGeometry.resolution_ij"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.D3Geometry.D3ProjectedGeometry.resolution_ij" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the distance to the nearest point of (i,j) point.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>i</strong> – X index of point in the 2D matrix of gridpoints</p></li>
<li><p><strong>j</strong> – Y index of point in the 2D matrix of gridpoints</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3ProjectedGeometry.resolution_ll">
<span class="sig-name descname"><span class="pre">resolution_ll</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/D3Geometry.html#D3ProjectedGeometry.resolution_ll"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.D3Geometry.D3ProjectedGeometry.resolution_ll" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the local resolution at the nearest point of lon/lat.
It’s the distance between this point and its closest neighbour.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lon</strong> – longitude of the point in degrees</p></li>
<li><p><strong>lat</strong> – latitude of the point in degrees</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3ProjectedGeometry.secant_projection">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">secant_projection</span></span><a class="headerlink" href="#epygram.geometries.D3Geometry.D3ProjectedGeometry.secant_projection" title="Permalink to this definition">¶</a></dt>
<dd><p>Is the projection secant to the sphere ? (or tangent)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3ProjectedGeometry.select_subzone">
<span class="sig-name descname"><span class="pre">select_subzone</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">subzone</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/D3Geometry.html#D3ProjectedGeometry.select_subzone"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.D3Geometry.D3ProjectedGeometry.select_subzone" title="Permalink to this definition">¶</a></dt>
<dd><p>If a LAMzone defines the geometry, select only the <em>subzone</em> from it
and return a new geometry object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>subzone</strong> – among (‘C’, ‘CI’).</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3ProjectedGeometry.structure">
<span class="sig-name descname"><span class="pre">structure</span></span><a class="headerlink" href="#epygram.geometries.D3Geometry.D3ProjectedGeometry.structure" title="Permalink to this definition">¶</a></dt>
<dd><p>Type of geometry (see the documentation above for more details).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3ProjectedGeometry.tolerant_equal">
<span class="sig-name descname"><span class="pre">tolerant_equal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tolerance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.220446049250313e-16</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/D3Geometry.html#D3ProjectedGeometry.tolerant_equal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.D3Geometry.D3ProjectedGeometry.tolerant_equal" title="Permalink to this definition">¶</a></dt>
<dd><p>Test of equality by recursion on the object’s attributes,
with a <strong>tolerance</strong>.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3ProjectedGeometry.vcoordinate">
<span class="sig-name descname"><span class="pre">vcoordinate</span></span><a class="headerlink" href="#epygram.geometries.D3Geometry.D3ProjectedGeometry.vcoordinate" title="Permalink to this definition">¶</a></dt>
<dd><p>Handles vertical geometry parameters (see the documentation above for more details).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3ProjectedGeometry.xy2ij">
<span class="sig-name descname"><span class="pre">xy2ij</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">position</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/D3Geometry.html#D3ProjectedGeometry.xy2ij"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.D3Geometry.D3ProjectedGeometry.xy2ij" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the (i, j) indexes of point <em>(x, y)</em>,
in the 2D matrix of gridpoints.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – X coordinate of point in the projection</p></li>
<li><p><strong>y</strong> – Y coordinate of point in the projection</p></li>
<li><p><strong>position</strong> – position to return with respect to the model cell.
Defaults to self.position_on_horizontal_grid.</p></li>
</ul>
</dd>
</dl>
<p>Caution: (<em>i,j</em>) are float (the nearest grid point is the nearest
integer).</p>
<p>Note that origin of coordinates in projection is the center of the C+I
domain.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3ProjectedGeometry.xy2ll">
<span class="sig-name descname"><span class="pre">xy2ll</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/D3Geometry.html#D3ProjectedGeometry.xy2ll"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.D3Geometry.D3ProjectedGeometry.xy2ll" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the (lon, lat) coordinates of point <em>(x, y)</em> in the 2D matrix
of gridpoints*(i,j)*, in degrees.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – X coordinate of point in the projection</p></li>
<li><p><strong>y</strong> – Y coordinate of point in the projection</p></li>
</ul>
</dd>
</dl>
<p>Note that origin of coordinates in projection is the center of the
C+I domain.</p>
</dd></dl>

</dd></dl>

<hr class="docutils" />
<dl class="py class">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3GaussGeometry">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">epygram.geometries.D3Geometry.</span></span><span class="sig-name descname"><span class="pre">D3GaussGeometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/D3Geometry.html#D3GaussGeometry"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.D3Geometry.D3GaussGeometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#epygram.geometries.D3Geometry.D3Geometry" title="epygram.geometries.D3Geometry.D3Geometry"><code class="xref py py-class docutils literal notranslate"><span class="pre">epygram.geometries.D3Geometry.D3Geometry</span></code></a></p>
<p>Handles the geometry for a Global Gauss grid 3-Dimensions Field.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This class is managed by footprint.</p>
<blockquote>
<div><ul class="simple">
<li><p>info: Not documented</p></li>
<li><p>priority: PriorityLevel::DEFAULT (rank=1)</p></li>
</ul>
</div></blockquote>
<p>Automatic parameters from the footprint:</p>
<blockquote>
<div><ul class="simple">
<li><p><strong>dimensions</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">footprints.stdtypes.FPDict</span></code>) - rxx - Handles grid dimensions.</p></li>
<li><p><strong>geoid</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">footprints.stdtypes.FPDict</span></code>) - rxx - To specify geoid shape.</p>
<ul>
<li><p>Optional. Default is FPDict::&lt;&lt;as_dict:: dict(ellps = ‘WGS84’,)&gt;&gt;.</p></li>
</ul>
</li>
<li><p><strong>grid</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">footprints.stdtypes.FPDict</span></code>) - rxx - Handles description of the horizontal grid.</p></li>
<li><p><strong>name</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">builtins.str</span></code>) - rxx - Name of geometrical type of representation of points on                       the Globe.</p>
<ul>
<li><p>Values: set([‘rotated_reduced_gauss’, ‘regular_gauss’, ‘reduced_gauss’])</p></li>
</ul>
</li>
<li><p><strong>position_on_horizontal_grid</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">builtins.str</span></code>) - rwx - Position of points w/r to the horizontal.</p>
<ul>
<li><p>Optional. Default is ‘__unknown__’.</p></li>
<li><p>Values: set([‘lower-right’, ‘upper-left’, ‘__unknown__’, ‘upper-right’, ‘center-right’, ‘lower-center’, ‘center-left’, ‘center’, ‘upper-center’, ‘lower-left’])</p></li>
</ul>
</li>
<li><p><strong>structure</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">builtins.str</span></code>) - rxx - Type of geometry.</p>
<ul>
<li><p>Values: set([‘3D’])</p></li>
</ul>
</li>
<li><p><strong>vcoordinate</strong> (<a class="reference internal" href="VGeometry.html#epygram.geometries.VGeometry.VGeometry" title="epygram.geometries.VGeometry.VGeometry"><code class="xref py py-class docutils literal notranslate"><span class="pre">epygram.geometries.VGeometry.VGeometry</span></code></a>) - rwx - Handles vertical geometry parameters.</p></li>
</ul>
</div></blockquote>
</div>
<dl class="py attribute">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3GaussGeometry.dimensions">
<span class="sig-name descname"><span class="pre">dimensions</span></span><a class="headerlink" href="#epygram.geometries.D3Geometry.D3GaussGeometry.dimensions" title="Permalink to this definition">¶</a></dt>
<dd><p>Handles grid dimensions (see the documentation above for more details).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3GaussGeometry.distance_to_nearest_neighbour_ij">
<span class="sig-name descname"><span class="pre">distance_to_nearest_neighbour_ij</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/D3Geometry.html#D3GaussGeometry.distance_to_nearest_neighbour_ij"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.D3Geometry.D3GaussGeometry.distance_to_nearest_neighbour_ij" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the distance to the nearest point of (i,j) point</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>i</strong> – X index of point in the 2D matrix of gridpoints</p></li>
<li><p><strong>j</strong> – Y index of point in the 2D matrix of gridpoints</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3GaussGeometry.distance_to_nearest_neighbour_ll">
<span class="sig-name descname"><span class="pre">distance_to_nearest_neighbour_ll</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/D3Geometry.html#D3GaussGeometry.distance_to_nearest_neighbour_ll"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.D3Geometry.D3GaussGeometry.distance_to_nearest_neighbour_ll" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the local resolution at the nearest point of lon/lat.
It’s the distance between this point and its closest neighbour.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lon</strong> – longitude of the point in degrees</p></li>
<li><p><strong>lat</strong> – latitude of the point in degrees</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3GaussGeometry.fill_maskedvalues">
<span class="sig-name descname"><span class="pre">fill_maskedvalues</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/D3Geometry.html#D3GaussGeometry.fill_maskedvalues"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.D3Geometry.D3GaussGeometry.fill_maskedvalues" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a copy of <em>data</em> with ‘real’ masked values (i.e. not those
linked to reduced Gauss) filled with <em>fill_value</em>.
<em>data</em> must be already 4D for simplicity reasons.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3GaussGeometry.geoid">
<span class="sig-name descname"><span class="pre">geoid</span></span><a class="headerlink" href="#epygram.geometries.D3Geometry.D3GaussGeometry.geoid" title="Permalink to this definition">¶</a></dt>
<dd><p>To specify geoid shape (see the documentation above for more details).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3GaussGeometry.get_datashape">
<span class="sig-name descname"><span class="pre">get_datashape</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">force_dimZ</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dimT</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d4</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">_</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/D3Geometry.html#D3GaussGeometry.get_datashape"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.D3Geometry.D3GaussGeometry.get_datashape" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the data shape according to the geometry.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>force_dimZ</strong> – if supplied, force the Z dimension instead of that
of the vertical geometry</p></li>
<li><p><strong>dimT</strong> – if supplied, is the time dimension to be added to the
data shape</p></li>
<li><p><strong>d4</strong> – <ul>
<li><p>if True,  shape is 4D (need to specify <em>dimT</em>)</p></li>
<li><p>if False, shape is 3D if dimZ &gt; 1 else 2D</p></li>
</ul>
</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3GaussGeometry.get_lonlat_grid">
<span class="sig-name descname"><span class="pre">get_lonlat_grid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">position</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d4</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nb_validities</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force_longitudes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">_</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/D3Geometry.html#D3GaussGeometry.get_lonlat_grid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.D3Geometry.D3GaussGeometry.get_lonlat_grid" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a tuple of two tables containing one the longitude of each
point, the other the latitude, with 2D shape.</p>
<p>Shape of 2D data in Gauss grids:</p>
<blockquote>
<div><ul class="simple">
<li><p>grid[0, 0:Nj] is first (Northern) band of latitude, masked after
Nj = number of longitudes for latitude j</p></li>
<li><p>grid[-1, 0:Nj] is last (Southern) band of latitude (idem).</p></li>
</ul>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>position</strong> – position of lonlat grid with respect to the model cell.
Defaults to self.position_on_horizontal_grid.</p></li>
<li><p><strong>d4</strong> – <ul>
<li><p>if True,  returned values are shaped in a 4 dimensions array</p></li>
<li><dl class="simple">
<dt>if False, shape of returned values is determined with respect to geometry.</dt><dd><p>d4=True requires nb_validities &gt; 0</p>
</dd>
</dl>
</li>
</ul>
</p></li>
<li><p><strong>nb_validities</strong> – number of validities represented in data values</p></li>
<li><p><strong>force_longitudes</strong> – if ‘positive’, the longitudes will be forced positive
if ‘]-180,180]’, the longitudes will be in the ]-180, 180] interval</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3GaussGeometry.grid">
<span class="sig-name descname"><span class="pre">grid</span></span><a class="headerlink" href="#epygram.geometries.D3Geometry.D3GaussGeometry.grid" title="Permalink to this definition">¶</a></dt>
<dd><p>Handles description of the horizontal grid (see the documentation above for more details).</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3GaussGeometry.gridpoints_number">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">gridpoints_number</span></span><a class="headerlink" href="#epygram.geometries.D3Geometry.D3GaussGeometry.gridpoints_number" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the number of gridpoints of the grid.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3GaussGeometry.horizontally_flattened">
<span class="sig-name descname"><span class="pre">horizontally_flattened</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/D3Geometry.html#D3GaussGeometry.horizontally_flattened"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.D3Geometry.D3GaussGeometry.horizontally_flattened" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a copy of <em>data</em> with horizontal dimensions flattened and
compressed (cf. numpy.ma.masked_array.compressed).
<em>data</em> must be 4D for simplicity reasons.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3GaussGeometry.ij2ll">
<span class="sig-name descname"><span class="pre">ij2ll</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">position</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/D3Geometry.html#D3GaussGeometry.ij2ll"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.D3Geometry.D3GaussGeometry.ij2ll" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the (lon, lat) coordinates of point <em>(i,j)</em>, in degrees.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>i</strong> – X index of point in the 2D matrix of gridpoints</p></li>
<li><p><strong>j</strong> – Y index of point in the 2D matrix of gridpoints</p></li>
<li><p><strong>position</strong> – lat lon position to return with respect to the model cell.
Defaults to self.position_on_horizontal_grid.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3GaussGeometry.isglobal">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">isglobal</span></span><a class="headerlink" href="#epygram.geometries.D3Geometry.D3GaussGeometry.isglobal" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>True if geometry is global</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3GaussGeometry.ll2ij">
<span class="sig-name descname"><span class="pre">ll2ij</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">position</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/D3Geometry.html#D3GaussGeometry.ll2ij"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.D3Geometry.D3GaussGeometry.ll2ij" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the (<em>i, j</em>) coordinates in the 2D matrix of gridpoints,
of the gridpoint nearest to (<em>lon</em>, <em>lat</em>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lon</strong> – longitude of point in degrees</p></li>
<li><p><strong>lat</strong> – latitude of point in degrees</p></li>
<li><p><strong>position</strong> – lat lon position to return with respect to the model cell.
Defaults to self.position_on_horizontal_grid.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3GaussGeometry.map_factor">
<span class="sig-name descname"><span class="pre">map_factor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/D3Geometry.html#D3GaussGeometry.map_factor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.D3Geometry.D3GaussGeometry.map_factor" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the map factor at the given longitude/latitude(s)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lon</strong> – longitude in degrees</p></li>
<li><p><strong>lat</strong> – latitude in degrees</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3GaussGeometry.map_factor_field">
<span class="sig-name descname"><span class="pre">map_factor_field</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">position</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/D3Geometry.html#D3GaussGeometry.map_factor_field"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.D3Geometry.D3GaussGeometry.map_factor_field" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a new field whose data is the map factor over the field.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>position</strong> – grid position with respect to the model cell.
Defaults to self.position_on_horizontal_grid.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3GaussGeometry.meridian_resolution_j">
<span class="sig-name descname"><span class="pre">meridian_resolution_j</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">j</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/D3Geometry.html#D3GaussGeometry.meridian_resolution_j"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.D3Geometry.D3GaussGeometry.meridian_resolution_j" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the average meridian resolution at longitude circle number <em>j</em>.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3GaussGeometry.name">
<span class="sig-name descname"><span class="pre">name</span></span><a class="headerlink" href="#epygram.geometries.D3Geometry.D3GaussGeometry.name" title="Permalink to this definition">¶</a></dt>
<dd><p>Name of geometrical type of representation of points on                       the Globe (see the documentation above for more details).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3GaussGeometry.nearest_points">
<span class="sig-name descname"><span class="pre">nearest_points</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">request</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">position</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">external_distance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">squeeze</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/D3Geometry.html#D3GaussGeometry.nearest_points"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.D3Geometry.D3GaussGeometry.nearest_points" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a list of the (i, j) position of the points needed to perform
an interpolation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lon</strong> – longitude of point in degrees.</p></li>
<li><p><strong>lat</strong> – latitude of point in degrees.</p></li>
<li><p><strong>request</strong> – <p>criteria for selecting the points, among:
* {‘n’:’1’} - the nearest point
* {‘n’:’2*2’} - the 2*2 square points around the position
* {‘n’:’4*4’} - the 4*4 square points around the position
* {‘n’:’N*N’} - the N*N square points around the position: N must be even
* {‘radius’:xxxx, ‘shape’:’square’} - the points which are xxxx metres</p>
<blockquote>
<div><p>around the position in X or Y direction</p>
</div></blockquote>
<ul>
<li><p>{‘radius’:xxxx, ‘shape’:’circle’} - the points within xxxx metres
around the position. (default shape == circle)</p></li>
</ul>
</p></li>
<li><p><strong>position</strong> – position in the model cell of the lat lon position.
Defaults to self.position_on_horizontal_grid.</p></li>
<li><p><strong>external_distance</strong> – can be a dict containing the target point value
and an external field on the same grid as self, to which the distance
is computed within the 4 horizontally nearest points; e.g.
{‘target_value’:4810, ‘external_field’:a_3DField_with_same_geometry}.
If so, the nearest point is selected with
distance = <a href="#id5"><span class="problematic" id="id6">|target_value - external_field.data|</span></a></p></li>
<li><p><strong>squeeze</strong> – True to suppress useless dimensions</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><p>general output form is [list, list, …, list]
with as many list items as the length of lon/lat.
Each list item is of the form [tuple, tuple, …, tuple]
with as many tuples as the request implies. A tuple
represents one of the nearest points associated with one
value taken from lon/lat. Each tuple as the form
(i, j).</p>
<p>Dimensions with a length of one are removed except if
squeeze is False. If squeeze is True and if request
implies only one nearest point, the list item of the general
output form is replaced by the tuple item; if length of
lon/lat is one, the output is directly the list item of
the general output form. Hence, if length of lon/lat is
one and the request implies only one point, the output is
a tuple.</p>
<p>In case of a simple square request, output is actually
an array. Otherwise, the output is as described (it cannot
be an array because the number of nearest points can vary
with the entry point).</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3GaussGeometry.point_is_inside_domain_ij">
<span class="sig-name descname"><span class="pre">point_is_inside_domain_ij</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">margin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">0.1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/D3Geometry.html#D3GaussGeometry.point_is_inside_domain_ij"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.D3Geometry.D3GaussGeometry.point_is_inside_domain_ij" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns True if the point(s) of lon/lat coordinates is(are) inside the
field.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>i</strong> – X index of point in the 2D matrix of gridpoints</p></li>
<li><p><strong>j</strong> – Y index of point in the 2D matrix of gridpoints</p></li>
<li><p><strong>margin</strong> – DEPRECATED</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3GaussGeometry.point_is_inside_domain_ll">
<span class="sig-name descname"><span class="pre">point_is_inside_domain_ll</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lon</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">_</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">__</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/D3Geometry.html#D3GaussGeometry.point_is_inside_domain_ll"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.D3Geometry.D3GaussGeometry.point_is_inside_domain_ll" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns True if the point(s) of lon/lat coordinates is(are) inside the
field.
This is always the case in Gauss grids, no real meaning.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lon</strong> – longitude of the point in degrees</p></li>
<li><p><strong>lat</strong> – latitude of the point in degrees</p></li>
<li><p><strong>margin</strong> – considers the point inside if at least ‘margin’ points far
from the border. The -0.1 default is a safety for precision errors.</p></li>
<li><p><strong>position</strong> – position of the grid with respect to the model cell.
Defaults to self.position_on_horizontal_grid.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3GaussGeometry.position_on_horizontal_grid">
<span class="sig-name descname"><span class="pre">position_on_horizontal_grid</span></span><a class="headerlink" href="#epygram.geometries.D3Geometry.D3GaussGeometry.position_on_horizontal_grid" title="Permalink to this definition">¶</a></dt>
<dd><p>Position of points w/r to the horizontal (see the documentation above for more details).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3GaussGeometry.reproject_wind_on_lonlat">
<span class="sig-name descname"><span class="pre">reproject_wind_on_lonlat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">map_factor_correction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reverse</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/D3Geometry.html#D3GaussGeometry.reproject_wind_on_lonlat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.D3Geometry.D3GaussGeometry.reproject_wind_on_lonlat" title="Permalink to this definition">¶</a></dt>
<dd><p>Reprojects a wind vector (u, v) on rotated/stretched sphere onto real
sphere, i.e. with components on true zonal/meridian axes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>u</strong> – the u == zonal-on-the-grid component of wind</p></li>
<li><p><strong>v</strong> – the v == meridian-on-the-grid component of wind</p></li>
<li><p><strong>lon</strong> – longitudes of points in degrees</p></li>
<li><p><strong>lat</strong> – latitudes of points in degrees</p></li>
<li><p><strong>map_factor_correction</strong> – applies a correction of magnitude due
to map factor.</p></li>
<li><p><strong>reverse</strong> – if True, apply the reverse reprojection.</p></li>
</ul>
</dd>
</dl>
<p>lon/lat are coordinates on real sphere.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3GaussGeometry.reshape_data">
<span class="sig-name descname"><span class="pre">reshape_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_dimension</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d4</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/D3Geometry.html#D3GaussGeometry.reshape_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.D3Geometry.D3GaussGeometry.reshape_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a 2D data (horizontal dimensions) reshaped from 1D,
according to geometry.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – the 1D data (or 3D with a T and Z dimensions,
or 2D with either a T/Z dimension, to be specified),
of dimension concording with geometry. In case data is 3D, T must be
first dimension and Z the second.</p></li>
<li><p><strong>first_dimension</strong> – in case data is 2D, specify what is the first
dimension of data among (‘T’, ‘Z’)</p></li>
<li><p><strong>d4</strong> – <ul>
<li><p>if True,  returned values are shaped in a 4 dimensions array</p></li>
<li><p>if False, shape of returned values is determined with respect to geometry</p></li>
</ul>
</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3GaussGeometry.resolution_field">
<span class="sig-name descname"><span class="pre">resolution_field</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">direction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'meridian'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/D3Geometry.html#D3GaussGeometry.resolution_field"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.D3Geometry.D3GaussGeometry.resolution_field" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a field whose values are the local resolution in m.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>direction</strong> – among (‘zonal’, ‘meridian’), direction in which
the resolution is computed.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3GaussGeometry.resolution_field_from_stretching">
<span class="sig-name descname"><span class="pre">resolution_field_from_stretching</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/D3Geometry.html#D3GaussGeometry.resolution_field_from_stretching"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.D3Geometry.D3GaussGeometry.resolution_field_from_stretching" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a field which values are the local resolution computed as the
nominal resolution stretched locally by the map factor.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3GaussGeometry.resolution_j">
<span class="sig-name descname"><span class="pre">resolution_j</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">j</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/D3Geometry.html#D3GaussGeometry.resolution_j"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.D3Geometry.D3GaussGeometry.resolution_j" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the average meridian resolution at longitude circle number j.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3GaussGeometry.resolution_ll">
<span class="sig-name descname"><span class="pre">resolution_ll</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/D3Geometry.html#D3GaussGeometry.resolution_ll"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.D3Geometry.D3GaussGeometry.resolution_ll" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the average meridian resolution (worst directional resolution)
at point position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lon</strong> – longitude of the point in degrees</p></li>
<li><p><strong>lat</strong> – latitude of the point in degrees</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3GaussGeometry.structure">
<span class="sig-name descname"><span class="pre">structure</span></span><a class="headerlink" href="#epygram.geometries.D3Geometry.D3GaussGeometry.structure" title="Permalink to this definition">¶</a></dt>
<dd><p>Type of geometry (see the documentation above for more details).</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3GaussGeometry.vcoordinate">
<span class="sig-name descname"><span class="pre">vcoordinate</span></span><a class="headerlink" href="#epygram.geometries.D3Geometry.D3GaussGeometry.vcoordinate" title="Permalink to this definition">¶</a></dt>
<dd><p>Handles vertical geometry parameters (see the documentation above for more details).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.D3Geometry.D3GaussGeometry.zonal_resolution_j">
<span class="sig-name descname"><span class="pre">zonal_resolution_j</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">j</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/D3Geometry.html#D3GaussGeometry.zonal_resolution_j"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.D3Geometry.D3GaussGeometry.zonal_resolution_j" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the average zonal resolution at longitude circle number j.</p>
</dd></dl>

</dd></dl>

</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="geometries_lib.html"
                        title="previous chapter"><code class="xref py py-mod docutils literal notranslate"><span class="pre">epygram.geometries</span></code> — Geometries</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="H2DGeometry.html"
                        title="next chapter"><code class="xref py py-mod docutils literal notranslate"><span class="pre">epygram.geometries.H2DGeometry</span></code> — Horizontal 2-D Geometry classes</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/library/D3Geometry.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="H2DGeometry.html" title="epygram.geometries.H2DGeometry — Horizontal 2-D Geometry classes"
             >next</a> |</li>
        <li class="right" >
          <a href="geometries_lib.html" title="epygram.geometries — Geometries"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">epygram 1.5.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" ><code class="xref py py-mod docutils literal notranslate"><span class="pre">epygram</span></code> — Package</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="geometries_lib.html" ><code class="xref py py-mod docutils literal notranslate"><span class="pre">epygram.geometries</span></code> — Geometries</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href=""><code class="xref py py-mod docutils literal notranslate"><span class="pre">epygram.geometries.D3Geometry</span></code> — 3-D Geometry class</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2014 --- 2022, A.Mary, S.Riette.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.3.2.
    </div>
  </body>
</html>