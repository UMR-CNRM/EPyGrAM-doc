
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>epygram.geometries.GaussGeometry — Gauss Geometry class &#8212; epygram 1.5.2 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinxdoc.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="epygram.geometries.RegLLGeometry — RegLL Geometry class" href="RegLLGeometry.html" />
    <link rel="prev" title="epygram.geometries.AcademicGeometry — Academic Geometry class" href="AcademicGeometry.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="RegLLGeometry.html" title="epygram.geometries.RegLLGeometry — RegLL Geometry class"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="AcademicGeometry.html" title="epygram.geometries.AcademicGeometry — Academic Geometry class"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">epygram 1.5.2 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" ><code class="xref py py-mod docutils literal notranslate"><span class="pre">epygram</span></code> main package</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="geometries_lib.html" accesskey="U"><code class="xref py py-mod docutils literal notranslate"><span class="pre">epygram.geometries</span></code> — Geometries</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href=""><code class="xref py py-mod docutils literal notranslate"><span class="pre">epygram.geometries.GaussGeometry</span></code> — Gauss Geometry class</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="epygram-geometries-gaussgeometry-gauss-geometry-class">
<h1><a class="reference internal" href="#module-epygram.geometries.GaussGeometry" title="epygram.geometries.GaussGeometry: Gauss Geometry class"><code class="xref py py-mod docutils literal notranslate"><span class="pre">epygram.geometries.GaussGeometry</span></code></a> — Gauss Geometry class<a class="headerlink" href="#epygram-geometries-gaussgeometry-gauss-geometry-class" title="Permalink to this headline">¶</a></h1>
<span class="target" id="module-epygram.geometries.GaussGeometry"></span><p>Contains the classes for 3D geometries of fields.</p>
<hr class="docutils" />
<dl class="py class">
<dt class="sig sig-object py" id="epygram.geometries.GaussGeometry.GaussGeometry">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">epygram.geometries.GaussGeometry.</span></span><span class="sig-name descname"><span class="pre">GaussGeometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dimensions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vcoordinate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">position_on_horizontal_grid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'__unknown__'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">geoid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/GaussGeometry.html#GaussGeometry"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.GaussGeometry.GaussGeometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="Geometry.html#epygram.geometries.AbstractGeometry.Geometry" title="epygram.geometries.AbstractGeometry.Geometry"><code class="xref py py-class docutils literal notranslate"><span class="pre">epygram.geometries.AbstractGeometry.Geometry</span></code></a></p>
<p>Handles the geometry for a Global Gauss grid 3-Dimensions Field.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> – Name of geometrical type of representation of points on the Globe.
Name must be among [‘rotated_reduced_gauss’, ‘reduced_gauss’, ‘regular_gauss’</p></li>
<li><p><strong>grid</strong> – Handles description of the horizontal grid.</p></li>
<li><p><strong>dimensions</strong> – Handles grid dimensions.</p></li>
<li><p><strong>vcoordinate</strong> – Handles vertical geometry parameters.</p></li>
<li><p><strong>position_on_horizontal_grid</strong> – <p>Position of points w/r to the horizontal.
among: [‘upper-right’, ‘upper-left’,</p>
<blockquote>
<div><p>’lower-left’, ‘lower-right’,
‘center-left’, ‘center-right’,
‘lower-center’, ‘upper-center’,
‘center’, ‘__unknown__’]</p>
</div></blockquote>
</p></li>
<li><p><strong>geoid</strong> – To specify geoid shape.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.GaussGeometry.GaussGeometry.default_cartopy_CRS">
<span class="sig-name descname"><span class="pre">default_cartopy_CRS</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#epygram.geometries.GaussGeometry.GaussGeometry.default_cartopy_CRS" title="Permalink to this definition">¶</a></dt>
<dd><div class="admonition note">
<p class="admonition-title">Note</p>
<p>Requires plugin: <strong>with_cartopy</strong> (config.activate_plugins)</p>
</div>
<p>Create a cartopy.crs appropriate to the Geometry.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.GaussGeometry.GaussGeometry.distance_to_nearest_neighbour_ij">
<span class="sig-name descname"><span class="pre">distance_to_nearest_neighbour_ij</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/GaussGeometry.html#GaussGeometry.distance_to_nearest_neighbour_ij"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.GaussGeometry.GaussGeometry.distance_to_nearest_neighbour_ij" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the distance to the nearest point of (i,j) point</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>i</strong> – X index of point in the 2D matrix of gridpoints</p></li>
<li><p><strong>j</strong> – Y index of point in the 2D matrix of gridpoints</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.GaussGeometry.GaussGeometry.distance_to_nearest_neighbour_ll">
<span class="sig-name descname"><span class="pre">distance_to_nearest_neighbour_ll</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/GaussGeometry.html#GaussGeometry.distance_to_nearest_neighbour_ll"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.GaussGeometry.GaussGeometry.distance_to_nearest_neighbour_ll" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the local resolution at the nearest point of lon/lat.
It’s the distance between this point and its closest neighbour.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lon</strong> – longitude of the point in degrees</p></li>
<li><p><strong>lat</strong> – latitude of the point in degrees</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.GaussGeometry.GaussGeometry.fill_maskedvalues">
<span class="sig-name descname"><span class="pre">fill_maskedvalues</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/GaussGeometry.html#GaussGeometry.fill_maskedvalues"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.GaussGeometry.GaussGeometry.fill_maskedvalues" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a copy of <em>data</em> with ‘real’ masked values (i.e. not those
linked to reduced Gauss) filled with <em>fill_value</em>.
<em>data</em> must be already 4D for simplicity reasons.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.GaussGeometry.GaussGeometry.get_datashape">
<span class="sig-name descname"><span class="pre">get_datashape</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">force_dimZ</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dimT</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d4</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">_</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/GaussGeometry.html#GaussGeometry.get_datashape"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.GaussGeometry.GaussGeometry.get_datashape" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the data shape according to the geometry.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>force_dimZ</strong> – if supplied, force the Z dimension instead of that
of the vertical geometry</p></li>
<li><p><strong>dimT</strong> – if supplied, is the time dimension to be added to the
data shape</p></li>
<li><p><strong>d4</strong> – <ul>
<li><p>if True,  shape is 4D (need to specify <em>dimT</em>)</p></li>
<li><p>if False, shape is 3D if dimZ &gt; 1 else 2D</p></li>
</ul>
</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.GaussGeometry.GaussGeometry.get_lonlat_grid">
<span class="sig-name descname"><span class="pre">get_lonlat_grid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">position</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d4</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nb_validities</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force_longitudes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">_</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/GaussGeometry.html#GaussGeometry.get_lonlat_grid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.GaussGeometry.GaussGeometry.get_lonlat_grid" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a tuple of two tables containing one the longitude of each
point, the other the latitude, with 2D shape.</p>
<p>Shape of 2D data in Gauss grids:</p>
<blockquote>
<div><ul class="simple">
<li><p>grid[0, 0:Nj] is first (Northern) band of latitude, masked after
Nj = number of longitudes for latitude j</p></li>
<li><p>grid[-1, 0:Nj] is last (Southern) band of latitude (idem).</p></li>
</ul>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>position</strong> – position of lonlat grid with respect to the model cell.
Defaults to self.position_on_horizontal_grid.</p></li>
<li><p><strong>d4</strong> – <ul>
<li><p>if True,  returned values are shaped in a 4 dimensions array</p></li>
<li><dl class="simple">
<dt>if False, shape of returned values is determined with respect to geometry.</dt><dd><p>d4=True requires nb_validities &gt; 0</p>
</dd>
</dl>
</li>
</ul>
</p></li>
<li><p><strong>nb_validities</strong> – number of validities represented in data values</p></li>
<li><p><strong>force_longitudes</strong> – if ‘positive’, the longitudes will be forced positive
if ‘]-180,180]’, the longitudes will be in the ]-180, 180] interval</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="epygram.geometries.GaussGeometry.GaussGeometry.gridpoints_number">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">gridpoints_number</span></span><a class="headerlink" href="#epygram.geometries.GaussGeometry.GaussGeometry.gridpoints_number" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the number of gridpoints of the grid.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.GaussGeometry.GaussGeometry.horizontally_flattened">
<span class="sig-name descname"><span class="pre">horizontally_flattened</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/GaussGeometry.html#GaussGeometry.horizontally_flattened"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.GaussGeometry.GaussGeometry.horizontally_flattened" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a copy of <em>data</em> with horizontal dimensions flattened and
compressed (cf. numpy.ma.masked_array.compressed).
<em>data</em> must be 4D for simplicity reasons.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.GaussGeometry.GaussGeometry.ij2ll">
<span class="sig-name descname"><span class="pre">ij2ll</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">position</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/GaussGeometry.html#GaussGeometry.ij2ll"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.GaussGeometry.GaussGeometry.ij2ll" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the (lon, lat) coordinates of point <em>(i,j)</em>, in degrees.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>i</strong> – X index of point in the 2D matrix of gridpoints</p></li>
<li><p><strong>j</strong> – Y index of point in the 2D matrix of gridpoints</p></li>
<li><p><strong>position</strong> – lat lon position to return with respect to the model cell.
Defaults to self.position_on_horizontal_grid.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="epygram.geometries.GaussGeometry.GaussGeometry.isglobal">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">isglobal</span></span><a class="headerlink" href="#epygram.geometries.GaussGeometry.GaussGeometry.isglobal" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>True if geometry is global</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.GaussGeometry.GaussGeometry.ll2ij">
<span class="sig-name descname"><span class="pre">ll2ij</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">position</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/GaussGeometry.html#GaussGeometry.ll2ij"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.GaussGeometry.GaussGeometry.ll2ij" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the (<em>i, j</em>) coordinates in the 2D matrix of gridpoints,
of the gridpoint nearest to (<em>lon</em>, <em>lat</em>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lon</strong> – longitude of point in degrees</p></li>
<li><p><strong>lat</strong> – latitude of point in degrees</p></li>
<li><p><strong>position</strong> – lat lon position to return with respect to the model cell.
Defaults to self.position_on_horizontal_grid.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.GaussGeometry.GaussGeometry.map_factor">
<span class="sig-name descname"><span class="pre">map_factor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/GaussGeometry.html#GaussGeometry.map_factor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.GaussGeometry.GaussGeometry.map_factor" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the map factor at the given longitude/latitude(s)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lon</strong> – longitude in degrees</p></li>
<li><p><strong>lat</strong> – latitude in degrees</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.GaussGeometry.GaussGeometry.map_factor_field">
<span class="sig-name descname"><span class="pre">map_factor_field</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">position</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/GaussGeometry.html#GaussGeometry.map_factor_field"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.GaussGeometry.GaussGeometry.map_factor_field" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a new field whose data is the map factor over the field.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>position</strong> – grid position with respect to the model cell.
Defaults to self.position_on_horizontal_grid.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.GaussGeometry.GaussGeometry.meridian_resolution_j">
<span class="sig-name descname"><span class="pre">meridian_resolution_j</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">j</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/GaussGeometry.html#GaussGeometry.meridian_resolution_j"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.GaussGeometry.GaussGeometry.meridian_resolution_j" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the average meridian resolution at longitude circle number <em>j</em>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.GaussGeometry.GaussGeometry.nearest_points">
<span class="sig-name descname"><span class="pre">nearest_points</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">request</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">position</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">external_distance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">squeeze</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/GaussGeometry.html#GaussGeometry.nearest_points"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.GaussGeometry.GaussGeometry.nearest_points" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a list of the (i, j) position of the points needed to perform
an interpolation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lon</strong> – longitude of point in degrees.</p></li>
<li><p><strong>lat</strong> – latitude of point in degrees.</p></li>
<li><p><strong>request</strong> – <p>criteria for selecting the points, among:
* {‘n’:’1’} - the nearest point
* {‘n’:’2*2’} - the 2*2 square points around the position
* {‘n’:’4*4’} - the 4*4 square points around the position
* {‘n’:’N*N’} - the N*N square points around the position: N must be even
* {‘radius’:xxxx, ‘shape’:’square’} - the points which are xxxx metres</p>
<blockquote>
<div><p>around the position in X or Y direction</p>
</div></blockquote>
<ul>
<li><p>{‘radius’:xxxx, ‘shape’:’circle’} - the points within xxxx metres
around the position. (default shape == circle)</p></li>
</ul>
</p></li>
<li><p><strong>position</strong> – position in the model cell of the lat lon position.
Defaults to self.position_on_horizontal_grid.</p></li>
<li><p><strong>external_distance</strong> – can be a dict containing the target point value
and an external field on the same grid as self, to which the distance
is computed within the 4 horizontally nearest points; e.g.
{‘target_value’:4810, ‘external_field’:a_3DField_with_same_geometry}.
If so, the nearest point is selected with
distance = <a href="#id1"><span class="problematic" id="id2">|target_value - external_field.data|</span></a></p></li>
<li><p><strong>squeeze</strong> – True to suppress useless dimensions</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><p>general output form is [list, list, …, list]
with as many list items as the length of lon/lat.
Each list item is of the form [tuple, tuple, …, tuple]
with as many tuples as the request implies. A tuple
represents one of the nearest points associated with one
value taken from lon/lat. Each tuple as the form
(i, j).</p>
<p>Dimensions with a length of one are removed except if
squeeze is False. If squeeze is True and if request
implies only one nearest point, the list item of the general
output form is replaced by the tuple item; if length of
lon/lat is one, the output is directly the list item of
the general output form. Hence, if length of lon/lat is
one and the request implies only one point, the output is
a tuple.</p>
<p>In case of a simple square request, output is actually
an array. Otherwise, the output is as described (it cannot
be an array because the number of nearest points can vary
with the entry point).</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.GaussGeometry.GaussGeometry.point_is_inside_domain_ij">
<span class="sig-name descname"><span class="pre">point_is_inside_domain_ij</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">margin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">0.1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/GaussGeometry.html#GaussGeometry.point_is_inside_domain_ij"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.GaussGeometry.GaussGeometry.point_is_inside_domain_ij" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns True if the point(s) of lon/lat coordinates is(are) inside the
field.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>i</strong> – X index of point in the 2D matrix of gridpoints</p></li>
<li><p><strong>j</strong> – Y index of point in the 2D matrix of gridpoints</p></li>
<li><p><strong>margin</strong> – DEPRECATED</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.GaussGeometry.GaussGeometry.point_is_inside_domain_ll">
<span class="sig-name descname"><span class="pre">point_is_inside_domain_ll</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lon</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">_</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">__</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/GaussGeometry.html#GaussGeometry.point_is_inside_domain_ll"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.GaussGeometry.GaussGeometry.point_is_inside_domain_ll" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns True if the point(s) of lon/lat coordinates is(are) inside the
field.
This is always the case in Gauss grids, no real meaning.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lon</strong> – longitude of the point in degrees</p></li>
<li><p><strong>lat</strong> – latitude of the point in degrees</p></li>
<li><p><strong>margin</strong> – considers the point inside if at least ‘margin’ points far
from the border. The -0.1 default is a safety for precision errors.</p></li>
<li><p><strong>position</strong> – position of the grid with respect to the model cell.
Defaults to self.position_on_horizontal_grid.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.GaussGeometry.GaussGeometry.reproject_wind_on_lonlat">
<span class="sig-name descname"><span class="pre">reproject_wind_on_lonlat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">map_factor_correction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reverse</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/GaussGeometry.html#GaussGeometry.reproject_wind_on_lonlat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.GaussGeometry.GaussGeometry.reproject_wind_on_lonlat" title="Permalink to this definition">¶</a></dt>
<dd><p>Reprojects a wind vector (u, v) on rotated/stretched sphere onto real
sphere, i.e. with components on true zonal/meridian axes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>u</strong> – the u == zonal-on-the-grid component of wind</p></li>
<li><p><strong>v</strong> – the v == meridian-on-the-grid component of wind</p></li>
<li><p><strong>lon</strong> – longitudes of points in degrees</p></li>
<li><p><strong>lat</strong> – latitudes of points in degrees</p></li>
<li><p><strong>map_factor_correction</strong> – applies a correction of magnitude due
to map factor.</p></li>
<li><p><strong>reverse</strong> – if True, apply the reverse reprojection.</p></li>
</ul>
</dd>
</dl>
<p>lon/lat are coordinates on real sphere.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.GaussGeometry.GaussGeometry.reshape_data">
<span class="sig-name descname"><span class="pre">reshape_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_dimension</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d4</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/GaussGeometry.html#GaussGeometry.reshape_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.GaussGeometry.GaussGeometry.reshape_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a 2D data (horizontal dimensions) reshaped from 1D,
according to geometry.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – the 1D data (or 3D with a T and Z dimensions,
or 2D with either a T/Z dimension, to be specified),
of dimension concording with geometry. In case data is 3D, T must be
first dimension and Z the second.</p></li>
<li><p><strong>first_dimension</strong> – in case data is 2D, specify what is the first
dimension of data among (‘T’, ‘Z’)</p></li>
<li><p><strong>d4</strong> – <ul>
<li><p>if True,  returned values are shaped in a 4 dimensions array</p></li>
<li><p>if False, shape of returned values is determined with respect to geometry</p></li>
</ul>
</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.GaussGeometry.GaussGeometry.resolution_field">
<span class="sig-name descname"><span class="pre">resolution_field</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">direction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'meridian'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/GaussGeometry.html#GaussGeometry.resolution_field"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.GaussGeometry.GaussGeometry.resolution_field" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a field whose values are the local resolution in m.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>direction</strong> – among (‘zonal’, ‘meridian’), direction in which
the resolution is computed.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.GaussGeometry.GaussGeometry.resolution_field_from_stretching">
<span class="sig-name descname"><span class="pre">resolution_field_from_stretching</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#epygram.geometries.GaussGeometry.GaussGeometry.resolution_field_from_stretching" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a field which values are the local resolution computed as the
nominal resolution stretched locally by the map factor.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.GaussGeometry.GaussGeometry.resolution_j">
<span class="sig-name descname"><span class="pre">resolution_j</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">j</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/GaussGeometry.html#GaussGeometry.resolution_j"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.GaussGeometry.GaussGeometry.resolution_j" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the average meridian resolution at longitude circle number j.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.GaussGeometry.GaussGeometry.resolution_ll">
<span class="sig-name descname"><span class="pre">resolution_ll</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/GaussGeometry.html#GaussGeometry.resolution_ll"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.GaussGeometry.GaussGeometry.resolution_ll" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the average meridian resolution (worst directional resolution)
at point position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lon</strong> – longitude of the point in degrees</p></li>
<li><p><strong>lat</strong> – latitude of the point in degrees</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="epygram.geometries.GaussGeometry.GaussGeometry.zonal_resolution_j">
<span class="sig-name descname"><span class="pre">zonal_resolution_j</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">j</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/epygram/geometries/GaussGeometry.html#GaussGeometry.zonal_resolution_j"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#epygram.geometries.GaussGeometry.GaussGeometry.zonal_resolution_j" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the average zonal resolution at longitude circle number j.</p>
</dd></dl>

</dd></dl>

</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="AcademicGeometry.html"
                        title="previous chapter"><code class="xref py py-mod docutils literal notranslate"><span class="pre">epygram.geometries.AcademicGeometry</span></code> — Academic Geometry class</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="RegLLGeometry.html"
                        title="next chapter"><code class="xref py py-mod docutils literal notranslate"><span class="pre">epygram.geometries.RegLLGeometry</span></code> — RegLL Geometry class</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/library/GaussGeometry.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="RegLLGeometry.html" title="epygram.geometries.RegLLGeometry — RegLL Geometry class"
             >next</a> |</li>
        <li class="right" >
          <a href="AcademicGeometry.html" title="epygram.geometries.AcademicGeometry — Academic Geometry class"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">epygram 1.5.2 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" ><code class="xref py py-mod docutils literal notranslate"><span class="pre">epygram</span></code> main package</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="geometries_lib.html" ><code class="xref py py-mod docutils literal notranslate"><span class="pre">epygram.geometries</span></code> — Geometries</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href=""><code class="xref py py-mod docutils literal notranslate"><span class="pre">epygram.geometries.GaussGeometry</span></code> — Gauss Geometry class</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2014 --- 2024, A.Mary, S.Riette.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.3.2.
    </div>
  </body>
</html>